2009-04-23  Phil Windley  <pjw@kynetx.com>

	* Kynetx/Rules.pm (eval_ruleset): Reset 'rule' name for each
	  ruleset for logging (MDC->put)
	* Kynetx/Actions.pm (build_one_action): Added support for native
	  config params
	* etc/js/0.9/kobj-extras.js: Change annotate_search_results to use
	  native config parameters.

2009-04-11  Phil Windley  <pjw@kynetx.com>

	* Kynetx/RuleManager.pm (lint_rule): Added some inital validation
  	  checking for rules on parsing to try and catch invalid select
	  patterns. 
	* Kynetx/Datasets.pm (mk_dataset_js): Changed dataset JS to store
	  in the KOBJ obj rather than as a standard var.
	* Kynetx/KOBJ.pm: Added data set definition defenses.
	* Kynetx/JSONPath.pm: Added to support pick expressions with
	  JSONPath patterns.  
	* Kynetx/JavaScript.pm (gen_js_expr): Added support for pick expressions.
	* Kynetx/Pick.pm: Added support for JSONPath based picks
	* Kynetx/PrettyPrinter.pm: Changes to support Parser changes.
	* Kynetx/Parser.pm: Support for new "pick" expression.  Pre decl is
	  now optional.


2009-04-04  Phil Windley  <pjw@kynetx.com>

	* extras/pilot/chrome/content/pilot/pilotOverlay.js: Modified to
	  support new initialziation sequence.
	* Kynetx/RuleManager.pm (handler): Updated to support multiple
	  ruleset evaluations in a single call.
	* Kynetx/KOBJ.pm: Removed KOBJ code.  Added datasets method.
	  Changed kobj.js generation to support new model for backwards
	  compatibility. 
	* etc/js/0.9/kobj-extras.js: Combined KOBJ code and updated to run
	  KOBJ.eval based on a configuration object

2009-04-03  Phil Windley  <pjw@kynetx.com>

	* Kynetx/RuleManager.pm: Fixed error reporting in parse API
	* Kynetx/Parser.pm: Fixed error reporting for component parsing in
	  support of parse API
	* etc/tmpl/httpd-perl.conf.tmpl: Load different startup file for KRL
	* startup-krl.pl: added new startup for KRL.  Patch until we redo
	  the respository

2009-03-27  Phil Windley  <pjw@kynetx.com>

	* Kynetx/Rules.pm (eval_rule): Wrapped generated JS in function
	  application to create namespace on the cheap to get ready for
	  multiple ruleset evaluations on a single page.
	* Kynetx/Actions.pm (build_one_action): updated setTimeout to use
  	  function instead of string so that we can use closure to capture
	  callbacks.
	* t/Actions.t: updated test for new setTimeout call.

2009-03-26  Phil Windley  <pjw@kynetx.com>

	* Kynetx/KOBJ.pm: refactored code that interprets API from URL
	  path info.  Added dispatch method and support code for returning
	  dispatch domain info.
	  (get_kobj): Fixed KOBJ for double loads.  Fixed KOBJ.host to be
	  more rebust.

2009-03-23  Phil Windley  <pjw@kynetx.com>

	* Kynetx/RuleManager.pm: Added parsing and unparsing methods for
	  meta and dispatch directives

2009-03-20  Phil Windley  <pjw@kynetx.com>

	* Kynetx/Repository.pm: Added to provide interface code (moved
	  from Rules.pm) for repository.
	* startup.pl: Added "use" for all major Kynetx libraries.
	* Kynetx/Datasets.pm: Added support for user declared datasets.
	* Kynetx/Request.pm: Generalized support for API path parsing and
	  bulkding the request envionment.
	* Kynetx/RuleManager.pm: Added generalized support for parsing and
	  unparsing rulesets, rules, and global decls in support of
	  Intersekt improvements.

2009-02-13  Phil Windley  <pjw@kynetx.com>

	* Kynetx/Parser.pm: Added support for logging pragma
	* Kynetx/Util.pm: Redid config_logging() to remove external
	  configuration files and added turn_on_logging() to support
	  logging pragma
	* pilot/pilotOverlay.js: Added test mode support code
	* pilot/pilotOverlay.xul: Added menu items for test mode.
	* Kynetx/Rules.pm (get_rule_set): Turn on logging when logging
	  pragma present
	* Kynetx/KOBJ.pm (get_kobj): Fixed bug with parameter pass thru

2009-02-10  Phil Windley  <pjw@kynetx.com>

	* etc/js/0.9/kgrowl-1.0.js: Added default value for opacity.  This
	  allows it to be changed.

2009-01-22  Phil Windley  <pjw@kynetx.com>

	* etc/tmpl/httpd-perl.conf.tmpl: Added config var for kobj_dir
	* bin/install-httpd-conf.pl: New was to calculate base dir from
	  where the program runs.
	* Kynetx/Version.pm: Added version functions
	* t/Version.t: Added tests for version number
	* t/dev/rules.t: Added pragma to ensure symbolic links are followed
	* t/dev/use.t: Added pragma to ensure symbolic links are followed

2009-01-12  Phil Windley  <pjw@kynetx.com>

	* bin/update.pl: Removed use of HTTP directives for
	  memcache configuration.
	* bin/install-httpd-conf.pl: Removed use of HTTP directives for
	  memcache configuration.
	* etc/tmpl/httpd-perl.conf.tmpl: Removed use of HTTP directives for
	  memcache configuration.
	* Kynetx.pm (handler): Removed use of HTTP directives for
	  memcache configuration.
	* Kynetx/Logger.pm (handler): Removed use of HTTP directives for
	  memcache configuration.
	* Kynetx/Memcached.pm: Gets memcached hosts from the
	  /web/etc/memcache_ips file instead of the http.conf file. This
	  allows better puppet configuration control.  

2009-01-10  Phil Windley  <pjw@kynetx.com>

	* Kynetx/PrettyPrinter.pm: Added support for meta block and description block
	* Kynetx/Parser.pm: Added support for meta block and description block
	* Kynetx.pm (describe_ruleset): Added "describe" method to hander
	* Kynetx/Rules.pm (get_rules_from_repository): Save ruleset verion
	  in memcached and retrieve it when you get rules from cache
	* t/cs.t: Added tests for the DESCRIBE method

2009-01-08  Phil Windley  <pjw@kynetx.com>

	* Kynetx.pm (handler): Fixed "flush" $site regexp to work with
	  non-numeric site ids
	* Kynetx/Console.pm: Fixed $site regexp to work with non-numeric
	  site ids
	* t/cs.t: Added tests for running ruleset server

2009-01-06  Phil Windley  <pjw@kynetx.com>

	* bin/update.pl: removed an incorrect switch from the call to
	  install-init-files.pl 

	* Kynetx/KOBJ.pm: Modified KOBJ.obs to work on clicks with inner HTML
	* bin/install-init-files.pl: Made Amazon S3 save optional and
	  restored file save for local files in case S3 isn't available.  
	

2009-01-05  Phil Windley  <pjw@kynetx.com>

	* Kynetx/Logger.pm: Added info field to callback logging
	* Kynetx/Parser.pm: Added notify action
	* Kynetx/Actions.pm: Added notify action

2008-12-08  Phil Windley  <pjw@kynetx.com>

	* Kynetx/KOBJ.pm (get_kobj): Added "static" URL for static file
	  that redirects to CloudFront.

2008-11-26  Phil Windley  <pjw@kynetx.com>

	* Kynetx/Rules.pm (process_rules): Changes to support non-numeric
 	  ruleset IDs.  

2008-10-30  Phil Windley  <pjw@kynetx.com>

	* Kynetx/Parser.pm: Added labels to emits.
	* Kynetx/Action.pm: Added callback calls and logging labels to emits

2008-10-28  Phil Windley  <pjw@kynetx.com>

	* Kynetx/KOBJ.pm (get_kobj): Updated the KOBJ.get_host function to
	  ignore protocol if present.  

2008-10-06  Phil Windley  <pjw@kynetx.com>

	* Kynetx/Actions.pm: Replaced all actions with JQuery-based
	  equivalents.  
	* Kynetx/KOBJ.pm: now sends JQuery JS libraries.  Version 0.9. 

2008-10-02  Phil Windley  <pjw@kynetx.com>

	* Kynetx/KOBJ.pm (get_kobj): wrapped Prototype effects for future
	  portability.  
	* widgets/weather.pl: Updated to use new wrapped effects

	* Kynetx/JavaScript.pm, Kynetx/KOBJ.pm, Kynetx/Actions.pm: updated
	  to use new K$ function in kobj-static.js rather than original $
	  function.  
	* install-init-files.pl: modifies stock Prototype files to change
	  $ function it K$ function.  

2008-09-23  Phil Windley  <pjw@kynetx.com>

	* Kynetx/Rules.pm (eval_rule): made sure null rule conditions are true

2008-09-22  Phil Windley  <pjw@kynetx.com>

	* Kynetx/JavaScript.pm (eval_datasource): added support for page IDs
	* Kynetx/Parser.pm: added syntax for 'emit'
	* Kynetx/Actions.pm: Added code to emit Javascript.
	* Kynetx/Actions.pm: Added support for change highlighting effect

2008-09-18  Phil Windley  <pjw@kynetx.com>

	* Parser rewrite complete.  Page variables added as a data source.
	76 files touched.  Ugh.   

2008-09-11  Phil Windley  <pjw@kynetx.com>

	* Kynetx/PrettyPrinter.pm: Rewrote to match changes to
  	  Parser.pm. Restructured expression syntax tree to be consistent
	  with predicates and easier to use.  

	* Kynetx/Parser.pm: Completely rewrote parser using RecDescent
	  Added new productions for predicate expressions, qualified data
	  functions and predicates, and value comparison in predicates.

2008-08-26  Phil Windley  <pjw@kynetx.com>

	* Kynetx/Actions.pm: Fixed numerous problems that made floats not
 	  work with IE.

2008-08-25  Phil Windley  <pjw@kynetx.com>

	* Kynetx/Actions.pm: Fixed error in action hash

	* etc/tmpl/httpd-perl.conf.tmpl: Added static P3P compact policy
	  header 

	* Kynetx/KOBJ.pm (get_kobj): Added support for private domains and
  	  more robust caller determination

2008-08-19  Phil Windley  <pjw@kynetx.com>

	* Kynetx/Predicates.pm (eval_predicates): Changed "exists" to
 	  "defined" when checking for counter predicate timeframes

2008-08-08  Phil Windley  <pjw@kynetx.com>

	* t/JavaScript.t (mk_datasource_function): added test for all
	  datasources
	* Kynetx/Location.pm new predicates for international in 
	* Kynetx/Actions.pm new actions for moving elements

2008-07-17  Phil Windley  <pjw@kynetx.com>

	* Kynetx/Session.pm (tie_servers): Sessions now using memcached
	for session storage rather than /web/data...  This is in
	anticipation of using memcachedb for session storage.
	
	* Kynetx/Predicates/MediaMarkets.pm: New predicates on functions
	surrounding the use of DMA codes to determine media markets

	* extras/dma/mk_db.pl: creates a DBX file for DMA codes

2008-07-10  Phil Windley  <pjw@kynetx.com>

	* Kynetx/Predicates/Referers.pm: Fixed remote and local referers
	* Kynetx/Predicate.pm: invalid predicates give warning now
	* t/Predicates/Markets.t: Made tests more realistic
	* Kynetx/Javascript.pm: Fixed bug in how args were passed to get_stocks

2008-07-02  Phil Windley  <pjw@kynetx.com>

	* bin/update.pl: Added support for fragment servers
	* Kynetx/JavaScript.pm: Added eval_js_expr to reduce a JS
	expression to a simple string, int, etc.   This is used in
	Actions.pm before grabbing a URL expression on the server.
	* Kynetx/Actions.pm (build_js_load): Run gen_js_pre before
	building rule_env so that decls get into rule_env as well as in
	the JS load.  
	* Kynetx/Actions.pm (choose_action): when we grab a URL, we eval
	it first in case it's an expression
	* Kynetx/Predicates/Time.pm (get_local_time): removed quotes from
	arg in timezone predicate
	* Kynetx/Predicates/Referers.pm (referer_domain): removed quotes
	from arg in timezone predicate
	* Kynetx/Session.pm (tie_servers): sessions now use memcached
	protocol.  At present they're configured to use the memcached
	servers, but they will eventually point to a memcachedb setup. 
	
	
2008-06-19  Phil Windley  <pjw@kynetx.com>

	* bin/update.pl: added this to make updating servers easier
	* added tests to Predicate file
	* fixed a few small bugs in predicates

2008-06-16  Phil Windley  <pjw@kynetx.com>

	* added the Mobile module and tests.  Adds the predicate
	'mobile()' which checks to see if the user agent is mobile.




