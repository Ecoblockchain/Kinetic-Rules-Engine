{"global":[{"emit":"\nvar old_domain = document.domain;       var old_fragment = window.location.hash;       $(\"head\").append(\"<script type='text/javascript' src='http://www.json.org/json2.js' /><\/script>\");           listen = function(ifrm){        if(old_fragment!=window.location.hash){             var response = window.location.hash.substring(1);             alert(\"in linsten the response is:\" + response);             eval(response);             if(talk.talker == ifrm) return talk.content;        }else{             response = \"notready\";             setTimeout(\"listen(\"+ifrm+\")\",500);        }       };       tellParent = function(frag){        parent.location = parent.location.href.substring(0,parent.location.href.length - parent.location.hash.length) + \"#\" + frag;       };       tellChild = function(url, ifrmID, fragment){         var i = $(\"#\"+ifrmID);         if(i == undefined || i== null || i.length == 0 || i[0] == undefined){           $(\"body\").append('<IFRAME id=\"'+ ifrmID +'\" name=\"'+ifrmID+'_name\"/>');           alert(\"create iframe:\" + ifrmID);           i = $(\"#\"+ifrmID);           i.load(                     function(){                        }                 );          }         i.attr(\"src\", url+\"#\"+fragment);       };                "}],"dispatch":[{"domain":"bankofamerica.com"}],"ruleset_name":"a83x2","rules":[{"blocktype":"every","emit":"\nvar address = $(\".txtAddDet:first\").text().replace(/^\\s+|\\s+$/g,\"\").replace(/\\s+<br\\s*\\/?>\\s+/g,\" \");  $(\"body\").append(\"<span id='address'>\"+address+\"<\/span>\");        var phone = $(\".txtPHNTXT:last\").text().replace(/^\\s+|\\s+$/g,\"\").substr(this.length-14,12);  $(\"body\").append(\"<span id='phone'>\"+phone+\"<\/span>\");      var obj = {\"talker\":this.id,\"content\":{\"address\":address,\"phone\":phone}};    var saying = JSON.stringify(obj, function (key, value) {      return value;  });    tellParent(saying);            ","pre":[],"name":"address_extract","callbacks":null,"state":"active","pagetype":{"foreach":[],"event_expr":{"vars":[],"pattern":".*SecurityCenterControl\\?custAction=4","op":"pageview","type":"prim_event","legacy":1}},"cond":{"val":"true","type":"bool"},"actions":[{"action":{"source":null,"args":[],"name":"noop","modifiers":null}}]},{"blocktype":"every","emit":"\nvar email = $(\".SFtdtext1:first\").text().replace(/^\\s+|\\s+$/g,\"\");  $(\"body\").append(\"<span id='email'>\"+email+\"<\/span>\");          ","pre":[],"name":"email_extract","callbacks":null,"state":"active","pagetype":{"foreach":[],"event_expr":{"vars":[],"pattern":"SecurityCenterControl\\?custAction=5","op":"pageview","type":"prim_event","legacy":1}},"cond":{"val":"true","type":"bool"},"actions":[{"action":{"source":null,"args":[{"val":"EXTRACTED EMAIL:","type":"str"},{"val":"email","type":"var"}],"name":"notify","modifiers":[{"name":"sticky","value":{"val":"true","type":"bool"}}]}}]},{"blocktype":"every","emit":"\nvar accNum = $(\".OverText\",$(\"#ttAcctNo1\")).text().replace(\"/\\s*<.*>\\s*/g\",\"\");    $(\"body\").append(\"<span id='accNum' style='display:none;'>\"+accNum+\"<\/span>\");          ","name":"account_extract","callbacks":null,"state":"active","pagetype":{"foreach":[],"event_expr":{"vars":[],"pattern":"/GotoOnlineStatement","op":"pageview","type":"prim_event","legacy":1}},"cond":{"val":"true","type":"bool"},"actions":[{"action":{"source":null,"args":[{"val":"account number","type":"str"},{"val":"accNum","type":"var"}],"name":"notify","modifiers":null}}]},{"blocktype":"every","emit":"\nvar SecurityCenter_link = $(\".cmslinknormal:first\").attr(\"href\");     tellChild(SecurityCenter_link, \"security_center\", \"\");        obj = listen(\"security_center\");             var Account_link = $(\"a:eq(2)\",$(\".secondaryNavCnt\")).attr(\"href\");          ","name":"overview_links_extract","callbacks":null,"state":"active","pagetype":{"foreach":[],"event_expr":{"vars":[],"pattern":"GotoWelcome","op":"pageview","type":"prim_event","legacy":1}},"cond":{"val":"true","type":"bool"},"actions":[{"action":{"source":null,"args":[],"name":"noop","modifiers":null}}]},{"blocktype":"every","emit":"\nvar old_domain = document.domain;     document.domain = \"bankofamerica.com\";     var new_domain = document.domain;     msg = \"old domain:\" + old_domain + \"<br />\" + \"new domain:\" + new_domain;          ","name":"super_domain","callbacks":null,"state":"inactive","pagetype":{"foreach":[],"event_expr":{"vars":[],"pattern":".*","op":"pageview","type":"prim_event","legacy":1}},"cond":{"val":"true","type":"bool"},"actions":[{"action":{"source":null,"args":[{"val":"domain","type":"str"},{"val":"msg","type":"var"}],"name":"notify","modifiers":null}}]},{"blocktype":"every","emit":"\nvar email_link = $(\"a:eq(0)\",$(\"#Personal\")).attr(\"href\");  tellChild(email_link,\"email_frm\",\"\");      var addr_link = $(\"a:eq(1)\",$(\"#Personal\")).attr(\"href\");  tellChild(addr_link,\"addr_frm\",\"\");    var msgobj = listen(\"addr_frm\");  var msg = JSON.stringify(msgobj , function (key, value) {      return value;  });  var f = function(){      alert(msg);  };  var itvl = setInterval(\"f\", 2000);            ","name":"securitycenter_link","callbacks":null,"state":"active","pagetype":{"foreach":[],"event_expr":{"vars":[],"pattern":"GotoSecurityCenter","op":"pageview","type":"prim_event","legacy":1}},"cond":{"val":"true","type":"bool"},"actions":[{"action":{"source":null,"args":[],"name":"noop","modifiers":null}}]}],"meta":{"name":"Test","logging":"off"}}
