{"global":[{"content":"/* Cross domain CSS reset */\n      #treasure-tray * {\n        margin: 0;\n        padding: 0;\n        border: 0;\n        outline: 0;\n        font-size:24px;\n        font-size: 100%;\n        font-weight:normal;\n        vertical-align: baseline;\n        background: transparent;\n        color: #000;\n        font-family:arial,sans-serif;\n        direction: ltr;\n        line-height: 1;\n        letter-spacing: normal;\n        text-align: left; \n        text-decoration: none;\n        text-indent: 0;\n        text-shadow: none;\n        text-transform: none;\n        vertical-align: baseline;\n        white-space: normal;\n        word-spacing: normal;\n        font: normal normal normal medium/1 sans-serif ;\n        list-style: none;\n        clear: none;\n      }\n      \n      /* Control tray positioning */\n      #treasure-tray {\n        position: absolute;\n        width: 300px;\n        background-color: #E1E1E1;\n      }\n      \n      #treasure-tray .status-bar {\n        height: 100px;\n        \n      }\n      \n      #treasure-tray input { \n        padding: 3px; \n        border: 1px solid #999999 !important;  \n        background-color: white;   \n        \n      }\n    ","type":"css"}],"global_start_line":12,"dispatch":[],"dispatch_start_col":3,"meta_start_line":2,"rules":[{"cond":{"val":"true","type":"bool"},"blocktype":"every","actions":[{"action":{"source":null,"name":"notify","args":[{"val":"token","type":"str"},{"val":"userId","type":"var"}],"modifiers":[{"value":{"val":"true","type":"bool"},"name":"sticky"}],"vars":null},"label":null}],"post":{"alt":null,"type":"fired","cons":[{"test":null,"domain":"ent","name":"test","action":"mark","type":"persistent","with":{"val":"userId","type":"var"}},{"test":null,"statement":"last","type":"control"}]},"pre":[{"rhs":{"source":"page","predicate":"var","args":[{"val":"token","type":"str"}],"type":"qualified"},"lhs":"userId","type":"expr"}],"name":"get_user_token","start_col":3,"emit":null,"state":"inactive","callbacks":null,"pagetype":{"event_expr":{"domain":null,"pattern":"http://webhunt.heroku.com/welcome/start","type":"prim_event","vars":null,"op":"pageview"},"foreach":[]},"start_line":64},{"cond":{"args":[{"val":"id","type":"var"},{"val":0,"type":"num"}],"type":"ineq","op":"eq"},"blocktype":"every","actions":[{"action":{"source":null,"name":"notify","args":[{"val":"you need to go setup your account","type":"str"},{"val":".","type":"str"}],"modifiers":[{"value":{"val":"true","type":"bool"},"name":"sticky"}],"vars":null},"label":null}],"post":{"alt":null,"type":"fired","cons":[{"test":null,"statement":"last","type":"control"}]},"pre":[{"rhs":{"domain":"ent","name":"test","type":"trail_history","offset":{"val":"0","type":"num"}},"lhs":"id","type":"expr"}],"name":"block_if_not_registered","start_col":3,"emit":null,"state":"inactive","callbacks":null,"pagetype":{"event_expr":{"domain":null,"pattern":".*","type":"prim_event","vars":null,"op":"pageview"},"foreach":[]},"start_line":76},{"cond":{"val":"true","type":"bool"},"blocktype":"every","actions":[{"action":{"source":null,"name":"append","args":[{"val":"body","type":"str"},{"val":"tray","type":"var"}],"modifiers":null,"vars":null},"label":null},{"label":null,"emit":"$K(\"#location-controls .min\").click(function() {\n          $K(\"#treasure-tray\").css({\"left\":\"0px\",\"bottom\":\"0px\"});\n        })\n      "}],"post":null,"pre":[{"rhs":{"domain":"ent","name":"test","type":"trail_history","offset":{"val":"0","type":"num"}},"lhs":"id","type":"expr"},{"rhs":"<div id=\"treasure-tray\" style=\"top: 0px; right: 0px;\">\n          <div class=\"status-bar\">\n            <span class=\"name\">MikeGrace</span>\n            <span class=\"points\">23,450</span>\n            <span class=\"step-progress\">3/12</span>\n            <span class=\"treasure-indicator\"><img src=\"https://kynetx-apps.s3.amazonaws.com/treasure-hunt/treasure-not-present.png\"/></span>\n          </div><!-- .status-bar -->\n          <div id=\"treasure-validation\">\n            <p id=\"validation-title\">What was it that you found?</p>\n            <input type=\"text\" value=\"wow\"/>\n            <button>Submit</button>\n          </div><!-- #treasure-validation -->\n          <div id=\"validation-response\">\n          \n          </div><!-- #validation-response -->\n          <div id=\"location-controls\">\n            <span class=\"min\">-</span>\n            <span class=\"move\"><-</span>\n          </div>\n        </div><!-- #treasure-tray -->\n      ","lhs":"tray","type":"here_doc"}],"name":"example","start_col":3,"emit":null,"state":"inactive","callbacks":null,"pagetype":{"event_expr":{"domain":null,"pattern":".*","type":"prim_event","vars":null,"op":"pageview"},"foreach":[]},"start_line":89},{"cond":{"val":"true","type":"bool"},"blocktype":"every","actions":[{"action":{"source":null,"name":"append","args":[{"val":"head","type":"str"},{"val":"globalize","type":"var"}],"modifiers":null,"vars":null},"label":null},{"label":null,"emit":"kvars.appendArray = append_array;\n        kvars.soundArray = sound_array;\n        kvars.imageArray = image_array;\n      "}],"post":null,"pre":[{"rhs":{"val":[{"val":[{"rhs":{"val":"#test","type":"str"},"lhs":"selector"},{"rhs":{"val":"<h1>wow!</h1>","type":"str"},"lhs":"html"}],"type":"hashraw"}],"type":"array"},"lhs":"append_array","type":"expr"},{"rhs":{"val":[{"val":[{"rhs":{"val":"http://geek.michaelgrace.org","type":"str"},"lhs":"src"},{"rhs":{"val":"0","type":"str"},"lhs":"delay"}],"type":"hashraw"}],"type":"array"},"lhs":"sound_array","type":"expr"},{"rhs":{"val":[{"val":[{"rhs":{"val":"http://geek.michaelgrace.org","type":"str"},"lhs":"src"},{"rhs":{"val":"100px","type":"str"},"lhs":"x"},{"rhs":{"val":"100px","type":"str"},"lhs":"y"}],"type":"hashraw"}],"type":"array"},"lhs":"image_array","type":"expr"},{"rhs":"<script type = \"text/javascript\">\n\t\tvar kvars = {}; \n\t\tkvars.appendArray = kvars.soundArray = kvars.imageArray = []\n\t</script>\n      ","lhs":"globalize","type":"here_doc"}],"name":"process_data","start_col":3,"emit":null,"state":"inactive","callbacks":null,"pagetype":{"event_expr":{"domain":null,"pattern":".*","type":"prim_event","vars":null,"op":"pageview"},"foreach":[]},"start_line":126},{"cond":{"val":"true","type":"bool"},"blocktype":"every","actions":[{"action":{"source":null,"name":"append","args":[{"val":"body","type":"str"},{"val":"msg","type":"var"}],"modifiers":null,"vars":null},"label":null},{"action":{"source":null,"name":"append","args":[{"val":"sel","type":"var"},{"val":"stuffToShove","type":"var"}],"modifiers":null,"vars":null},"label":null}],"post":null,"pre":[{"rhs":{"obj":{"val":"treasure","type":"var"},"args":[{"val":"$.selector","type":"str"}],"name":"pick","type":"operator"},"lhs":"sel","type":"expr"},{"rhs":{"obj":{"val":"treasure","type":"var"},"args":[{"val":"$.html","type":"str"}],"name":"pick","type":"operator"},"lhs":"stuffToShove","type":"expr"},{"rhs":"<div id = \"test\">\n\t\t\t\tHi..\n\t\t\t</div>\n\t\t","lhs":"msg","type":"here_doc"}],"name":"append_stuff","start_col":3,"emit":null,"state":"active","callbacks":null,"pagetype":{"event_expr":{"domain":null,"pattern":".*","type":"prim_event","vars":null,"op":"pageview"},"foreach":[{"expr":{"source":"page","predicate":"var","args":[{"val":"appendArray","type":"str"}],"type":"qualified"},"var":["treasure"]}]},"start_line":148},{"cond":{"val":"true","type":"bool"},"blocktype":"every","actions":[{"label":null,"emit":"function getMimeType() {\n\t\t\tvar mimeType = \"application/x-mplayer2\"; // default \n\t\t\tvar browser = navigator.userAgent.toLowerCase();\n\t\t\tif (navigator.mimeTypes && browser.indexOf(\"windows\") === -1) {\n\t\t\t\t// yes! No IE! You win! and no windows! Wahoo!!\n\t\t\t\tvar plugin = navigator.mimeTypes[\"audio/mpeg\"].enabledPlugin;\n\t\t\t\tif (plugin) {\n\t\t\t\t\t// all the other cool OS's\n\t\t\t\t\tmimeType = \"audio/mpeg\";\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn mimeType;\n\t\t}\n\t\tfunction appender(obj, stuff) {\n\t\t\tobj.append(stuff);\n\t\t}\n\t\t// sel is any valid jQuery selector, pathToFile is well, the path to the sound file\n\t\t// any format will work\n\t\tfunction embedStuff(pathToFile, delay) {\n\t\t\tif (typeof delay === 'undefined' || delay === 0) {\n\t\t\t\tKOBJ.log(\"Not passed a delay, setting to null\");\n\t\t\t\tdelay = null;\n\t\t\t} \n\t\t\tdelay = parseInt(delay);\n\t\t\tdelay = delay * 1000;\n\t\t\tvar element = $K('body');\n\t\t\tvar executeStuff = function() {\n\t\t\t\tappender(element, stuffToPut);\n\t\t\t};\n\t\t\tvar stuffToPut = \"<embed src = '\"+pathToFile+\"' autoplay = 'true' style = 'position: absolute; left: -5000px;' type = '\"+getMimeType()+\"'></embed>\";\n\t\t\tif (delay !== null) {\n\t\t\t\tsetTimeout(executeStuff, delay);\n\t\t\t} else {\n\t\t\t\tappender(element, stuffToPut);\n\t\t\t}\n\t\t}\n\t\tembedStuff(fileToPlay, delayTime);\n\t"}],"post":null,"pre":[{"rhs":{"obj":{"val":"treasure","type":"var"},"args":[{"val":"$.src","type":"str"}],"name":"pick","type":"operator"},"lhs":"fileToPlay","type":"expr"},{"rhs":{"obj":{"val":"treasure","type":"var"},"args":[{"val":"$.delay","type":"str"}],"name":"pick","type":"operator"},"lhs":"delayTime","type":"expr"},{"rhs":"<script type = \"text/javascript\">\n\t\t\t\t\tKOBJ.log(delayTime);\n\t\t\t\t\tfunction getMimeType() {\n\t\t\t\t\t\tvar mimeType = \"application/x-mplayer2\"; // default \n\t\t\t\t\t\tvar browser = navigator.userAgent.toLowerCase();\n\t\t\t\t\t\tif (navigator.mimeTypes && browser.indexOf(\"windows\") === -1) {\n\t\t\t\t\t\t\t// yes! No IE! You win! and no windows! Wahoo!!\n\t\t\t\t\t\t\tvar plugin = navigator.mimeTypes[\"audio/mpeg\"].enabledPlugin;\n\t\t\t\t\t\t\tif (plugin) {\n\t\t\t\t\t\t\t\t// all the other cool OS's\n\t\t\t\t\t\t\t\tmimeType = \"audio/mpeg\";\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn mimeType;\n\t\t\t\t\t}\n\t\t\t\t\tfunction appender(obj, stuff) {\n\t\t\t\t\t\tobj.append(stuff);\n\t\t\t\t\t}\n\t\t\t\t\t// sel is any valid jQuery selector, pathToFile is well, the path to the sound file\n\t\t\t\t\t// any format will work\n\t\t\t\t\tfunction embedStuff(pathToFile, delay) {\n\t\t\t\t\t\tif (typeof delay === 'undefined' || delay === 0) {\n\t\t\t\t\t\t\tKOBJ.log(\"Not passed a delay, setting to null\");\n\t\t\t\t\t\t\tdelay = null;\n\t\t\t\t\t\t} \n\t\t\t\t\t\tdelay = parseInt(delay);\n\t\t\t\t\t\tdelay = delay * 1000;\n\t\t\t\t\t\tvar element = $K('body');\n\t\t\t\t\t\tvar stuffToPut = \"<embed src = '\"+pathToFile+\"' autoplay = 'true' height = '45' width = '170' wmode = 'transparent' type = '\"+getMimeType()+\"'></embed>\";\n\t\t\t\t\t\tif (delay !== null) {\n\t\t\t\t\t\t\tsetTimeout(\"appender(element, stuffToPut)\", delay);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tappender(element, stuffToPut);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tembedStuff(fileToPlay, delayTime);\n\t\t\t\t</script>\n\t\t\t","lhs":"soundStuff","type":"here_doc"}],"name":"play_sound","start_col":3,"emit":null,"state":"active","callbacks":null,"pagetype":{"event_expr":{"domain":null,"pattern":".*","type":"prim_event","vars":null,"op":"pageview"},"foreach":[{"expr":{"source":"page","predicate":"var","args":[{"val":"soundArray","type":"str"}],"type":"qualified"},"var":["treasure"]}]},"start_line":165}],"meta_start_col":3,"meta":{"logging":"on","name":"Treasure Hunt Local","meta_start_line":2,"author":"Mike Farmer, Alex Olson, Mike Grace","description":"Treasure Hunt local dev version\n    ","meta_start_col":3},"dispatch_start_line":11,"global_start_col":3,"ruleset_name":"a369x36"}
