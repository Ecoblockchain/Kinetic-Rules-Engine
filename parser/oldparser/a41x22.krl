{"global":[{"source":"http://www.rottentomatoes.com/m/","name":"rottenTomatoesScore","type":"datasource","datatype":"JSON","cachable":{"period":"minutes","value":"30"}},{"source":"http://query.yahooapis.com/v1/public/yql?","name":"yql","type":"datasource","datatype":"JSON","cachable":{"period":"minutes","value":"30"}},{"source":"http://www.blockbuster.com/download/stores/storelocator/findStoresWithTitleAvailability?","name":"blockBusterSearch","type":"datasource","datatype":"JSON","cachable":{"period":"seconds","value":"5"}},{"emit":"function kNotify(header, msg) {    \t\tconfig=\"{txn_id: 'C21CE5BA-5B86-11DE-8D16-C767F8606F2B',rule_name: 'facebookimage','opacity':.95,'width':'400px'}\";    \t\tuniq = (Math.round(Math.random()*100000000)%100000000);    \t\t$K.kGrowl.defaults.header = header;    \t\tif(typeof config === 'object') {    \t\t\tjQuery.extend($K.kGrowl.defaults,config);    \t}    \t$K.kGrowl(msg);        }                    "}],"global_start_line":15,"dispatch":[{"domain":"netflix.com","ruleset_id":null},{"domain":"hollywoodvideo.com","ruleset_id":null},{"domain":"blockbuster.com","ruleset_id":null},{"domain":"example.com","ruleset_id":null}],"dispatch_start_col":5,"meta_start_line":2,"rules":[{"cond":{"val":"true","type":"bool"},"blocktype":"every","actions":[{"action":{"source":null,"name":"noop","args":[],"modifiers":null},"label":null}],"post":null,"pre":[{"rhs":{"args":[{"val":"http://www.blockbuster.com/browse/search/product/products/?keyword=","type":"str"},{"val":"title","type":"var"}],"type":"prim","op":"+"},"lhs":"toSearch","type":"expr"},{"rhs":"q=select%20*%20from%20html%20where%20url%3D'\n ","lhs":"queryBase","type":"here_doc"},{"rhs":"'&format=json&callback=&diagnostics=off\n ","lhs":"queryEnd","type":"here_doc"},{"rhs":{"args":[{"val":"queryBase","type":"var"},{"args":[{"val":"toSearch","type":"var"},{"val":"queryEnd","type":"var"}],"type":"prim","op":"+"}],"type":"prim","op":"+"},"lhs":"query","type":"expr"},{"rhs":{"source":"datasource","predicate":"yql","args":[{"val":"query","type":"var"}],"type":"qualified"},"lhs":"bbResults","type":"expr"},{"rhs":{"obj":{"val":"bbResults","type":"var"},"args":[{"val":"$..results.div.div.id","type":"str"}],"name":"pick","type":"operator"},"lhs":"id","type":"expr"},{"rhs":{"source":"location","predicate":"postal_code","args":[],"type":"qualified"},"lhs":"zip_temp","type":"expr"},{"rhs":{"val":"","type":"str"},"lhs":"emp_string","type":"expr"},{"rhs":{"val":"84660","type":"str"},"lhs":"default_zip","type":"expr"},{"rhs":"#{ zip_temp == emp_string ? zip = default_zip : zip = zip_temp }\n ","lhs":"zip","type":"here_doc"},{"rhs":{"source":"datasource","predicate":"blockBusterSearch","args":[{"args":[{"val":"movieId=","type":"str"},{"args":[{"val":"id","type":"var"},{"args":[{"val":"&storeLocatorRequest.address.zipCode=","type":"str"},{"val":"zip","type":"var"}],"type":"prim","op":"+"}],"type":"prim","op":"+"}],"type":"prim","op":"+"}],"type":"qualified"},"lhs":"bbPage","type":"expr"}],"name":"netflix","start_col":5,"emit":"console.log(bbResults);  \t  \tblockBusterMsg = \"<div id='BlockBuster'>BlockBuster lookup is not working</div>\";  \t  \t\t  \t\tfunction testAvailable(foobar) {  \t\t\tthisHere = $K(foobar);  \t\t\ttestText = $K(\"td:eq(5)\",thisHere).text();  \t\t\tif(!testText.match(\"Yes\")) {  \t\t\t\treturn true;  \t\t\t}  \t\t\telse {  \t\t\t\treturn false;  \t\t\t}  \t\t}      \t\ttableRows = $K(\".storeTable>tbody>tr\",bbPage);  \t\tavailable = $K(\".bta + td\",bbPage);  \t\tconsole.log(tableRows, \"      \", available);  \t\t  \t\ttableRows.each(function() {  \t\t\tconsole.log(this);  \t\t\ttoPass = $K(this);  \t\t\tif(testAvailable(toPass)) {  \t\t\t\tdistance = $K(\"td:eq(1)\",toPass).text();  \t\t\t\taddress = $K(\"td:eq(3)\",toPass).html();  \t\t\t\taddressText = $K(\"td:eq(3)\",toPass).text();  \t\t\t\tphone = $K(\"td:eq(7)\",toPass).text();  \t\t\t\t  \t\t\t\tblockBusterMsg = \"<div id='BlockBuster' style='display:none'><table style='padding: 10px'><tbody><tr><td><img align='left' height='100px' hspace='10' src='http://www.dmwmedia.com/sites/default/files/images/BlockbusterLogo2004.jpg' /></td><td><p>This title is available at a Blockbuster \" + distance + \" miles away. The address of this store is:</p><p>\" + address + \"</p><p>or call \" + phone + \" to reserve.</p></td></tr></tbody></table></div>\";  \t\t\t\treturn false;  \t\t\t}  \t\t\telse {  \t\t\t\taddress = $K(\".storeTable>tbody>tr:eq(0)>td:eq(3)\",bbPage).html();  \t\t\t\tblockBusterMsg = '<div style=\"display:none; text-align:center\" id=\"BlockBuster\"><p>This title is not available at a BlockBuster near '+zip+'.</p></div>';      \t\t\t}  \t\t});  \t\t    \t  \t\t$K(\"#leftcol>div>div:eq(1)\").prepend(blockBusterMsg);  \t\t$K(\"#BlockBuster\").slideDown(\"slow\");            ","state":"inactive","callbacks":null,"pagetype":{"event_expr":{"pattern":"netflix.com/Movie/(\\w+)/","legacy":1,"type":"prim_event","vars":["title"],"op":"pageview"},"foreach":[]},"start_line":22},{"cond":{"val":"true","type":"bool"},"blocktype":"every","actions":[{"action":{"source":null,"name":"popup","args":[{"val":250,"type":"num"},{"val":250,"type":"num"},{"val":150,"type":"num"},{"val":400,"type":"num"},{"val":"http://www.confettiantiques.com","type":"str"}],"modifiers":null},"label":null}],"post":null,"pre":null,"name":"hollywood","start_col":5,"emit":null,"state":"inactive","callbacks":null,"pagetype":{"event_expr":{"pattern":"hollywoodvideo.com/movies/","legacy":1,"type":"prim_event","vars":[],"op":"pageview"},"foreach":[]},"start_line":48},{"cond":{"val":"true","type":"bool"},"blocktype":"every","actions":[{"action":{"source":null,"name":"notify","args":[{"val":"Hello","type":"str"},{"val":"BB","type":"str"}],"modifiers":null},"label":null}],"post":null,"pre":null,"name":"bb","start_col":5,"emit":null,"state":"inactive","callbacks":null,"pagetype":{"event_expr":{"pattern":".*","legacy":1,"type":"prim_event","vars":[],"op":"pageview"},"foreach":[]},"start_line":53}],"meta_start_col":5,"meta":{"logging":"off","name":"Movies","meta_start_line":2,"description":"checks ratings from Rotten Tomatoes and displays them. Also checks to see if movie is available near your local area.     \n","meta_start_col":5},"dispatch_start_line":9,"global_start_col":5,"ruleset_name":"a41x22"}
