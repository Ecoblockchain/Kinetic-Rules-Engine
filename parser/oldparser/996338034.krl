{"global":[],"global_start_line":null,"dispatch":[{"domain":"www.google.com","ruleset_id":null},{"domain":"search.yahoo.com","ruleset_id":null},{"domain":"search.msn.com","ruleset_id":null},{"domain":"search.live.com","ruleset_id":null},{"domain":"www.bing.com","ruleset_id":null}],"dispatch_start_col":5,"meta_start_line":null,"rules":[{"cond":{"val":"true","type":"bool"},"blocktype":"every","actions":[{"action":{"source":null,"name":"noop","args":[],"modifiers":null,"vars":null},"label":null}],"post":null,"pre":null,"name":"testannotate","start_col":5,"emit":"KOBJ.annotate_search_results = function(annotate, config, cb) {    var defaults = {      \"name\": \"KOBJ\",      \"sep\": \"<div style='padding-top: 13px'>|</div>\",      \"text_color\": \"#CCC\",      \"height\": \"40px\",      \"left_margin\": \"15px\",      \"right_padding\": \"15px\",      \"font_size\": \"12px\",      \"font_family\": \"Verdana, Geneva, sans-serif\",      \"results_lister\" : \"li.g, div.g, li div.res, #results>ul>li, #sw_main>.sr_dcard\",      \"element_to_modify\" : \"div.s,div.abstr,p\",      \"placement\" : 'prepend',      \"outer_div_css\" : 0,      \"inner_div_css\" : 0,      \"li_css\" : 0,      \"ul_css\" : 0    };    if (typeof config === 'object') {        jQuery.extend(defaults, config);    }      defaults.outer_div_css = defaults.outer_div_css || {        \"float\": \"right\",        \"width\": \"auto\",        \"height\": defaults.height,        \"font-size\": defaults.font_size,        \"line-height\": \"normal\",        \"font-family\": defaults.font_family        };    defaults.li_css = defaults.li_css || {        \"float\": \"left\",        \"margin\": \"0\",        \"vertical-align\": \"middle\",        \"padding-left\": \"4px\",        \"color\": defaults.text_color,        \"white-space\": \"nowrap\",        \"text-align\": \"center\"        };    defaults.ul_css = defaults.ul_css || {        \"margin\": \"0\",        \"padding\": \"0\",        \"list-style\": \"none\"        };    defaults.inner_div_css = defaults.inner_div_css || {        \"float\": \"left\",        \"display\": \"inline\",        \"height\": defaults.height,        \"margin-left\": defaults.left_margin,        \"padding-right\": defaults.right_padding        };    function mk_list_item(i) {      return $K(\"<li class='\" + defaults.name + \"_item'>\").css(defaults.li_css).append(i);    }    function mk_outer_div(anchor) {        var name = defaults.name;        var logo_item = mk_list_item(anchor);        var logo_list = $K('<ul>').css(defaults.ul_css).attr(\"id\", name + \"_anno_list\").append(logo_item);        var inner_div = $K('<div>').css(defaults.inner_div_css).append(logo_list);        if (typeof defaults != 'undefined' && defaults['tail_image']) {            inner_div.css({                \"background-image\": \"url(\" + defaults['tail_image'] + \")\",                \"background-repeat\": \"no-repeat\",                \"background-position\": \"right top\"            });        }        var outer_div = $K('<div>').css(defaults.outer_div_css).append(inner_div);        if (typeof defaults != 'undefined' && defaults['head_image']) {            outer_div.css({                \"background-image\": \"url(\" + defaults['head_image'] + \")\",                \"background-repeat\": \"no-repeat\",                \"background-position\": \"left top\"            });        }        return outer_div;    }    var annotatedMarker = \"Kannotated\" + (new Date().getTime());  \tKOBJ.log(\"marker: \"+annotatedMarker);    function runAnnotate(){      var notAlreadyAnnotated = $K(\".\"+annotatedMarker).length === 0;        var resultslist = $K(defaults['results_lister']);      if(resultslist.length == 0){ return; }        var count = 0;      if(notAlreadyAnnotated){  \t$K('*:first', resultslist.get(0)).addClass(annotatedMarker);  \tresultslist.each(function() {  \t     var contents = annotate(this);  \t     if (contents) {  \t\tcount++;  \t       if ($K(this).find('#' + defaults.name + '_anno_list li').is('.' + defaults.name + '_item')) {  \t         $K(this).find('#' + defaults.name + '_anno_list').append(mk_list_item(defaults.sep)).append(mk_list_item(contents));  \t       } else {  \t         $K(this).find(defaults['element_to_modify'])[defaults.placement](mk_outer_div(contents));  \t}  \t     }  \t   }  \t   );         KOBJ.logger('annotated_search_results', config['txn_id'], count, '', 'success', config['rule_name'], config['rid'] );      }      cb();    };  \trunAnnotate();  \tsetInterval(runAnnotate,100);    };          function test_selector(obj){  \tvar entryURL = $K(obj).find(\"span.url, cite\").text();  \tvar host = KOBJ.get_host(entryURL);    \tKOBJ.log(\"annotating\", entryURL, host);  \treturn \"cheese\";  }    KOBJ.log(\"rule ran!\");    KOBJ.annotate_search_results(test_selector, {}, function(){});              ","state":"active","callbacks":null,"pagetype":{"event_expr":{"pattern":"www.google.com\\/|search.yahoo.com\\/|search.msn.com\\/|www.bing.com\\/|www.ask.com\\/","legacy":1,"type":"prim_event","vars":[],"op":"pageview"},"foreach":[]},"start_line":9}],"meta_start_col":null,"meta":{},"dispatch_start_line":2,"global_start_col":null,"ruleset_name":"996338034"}
