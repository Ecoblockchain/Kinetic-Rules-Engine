{"global":[{"emit":"match_data =        {\"spider house\" :         [{\"link\": \"http://www.spiderhousecafe.com\",           \"text\": \"kiimby network!\"          }         ]       };                "}],"global_start_line":14,"dispatch":[{"domain":"www.google.com","ruleset_id":null},{"domain":"search.yahoo.com","ruleset_id":null}],"dispatch_start_col":5,"meta_start_line":2,"rules":[{"cond":{"val":"true","type":"bool"},"blocktype":"every","actions":[{"action":{"source":null,"name":"annotate_search_results","args":[{"val":"my_selector","type":"var"}],"modifiers":null,"vars":null},"label":null}],"post":null,"pre":null,"name":"annotate","start_col":5,"emit":"function my_selector(obj){    function mk_anchor (o) {      return $K('<a href=' + o.link + '/>').attr(        {\"class\": 'annotation_click',         \"title\": o.text || \"Click here for discounts!\"        }).html(\"Click Here!\");    }      var host = KOBJ.get_host($K(obj).find(\"span.url, cite\").text());    var o = KOBJ.pick(match_data[host]);    if(o) {       return mk_anchor(o);    } else {       false;    }  }            ","state":"active","callbacks":null,"pagetype":{"event_expr":{"pattern":"www.google.com|search.yahoo.com","legacy":1,"type":"prim_event","vars":[],"op":"pageview"},"foreach":[]},"start_line":18}],"meta_start_col":5,"meta":{"logging":"off","name":"kiimby","meta_start_line":2,"author":"Phil Windley","description":"Demonstration of search annotation.  Writing the selection function (in the emit in the rule) is the part where you get to choose how the annotation works and where it happens.  I've chosen to put the data for matching (because there wasn't much) in an emit int he Global section. This is better done with a dataset or datasource call for large, frequently updated datasets.        \n","meta_start_col":5},"dispatch_start_line":10,"global_start_col":5,"ruleset_name":"a25x4"}
