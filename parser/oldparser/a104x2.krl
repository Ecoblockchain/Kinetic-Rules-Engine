{"global":[{"source":"http://service.azigo.com/updates/kynetx/datasets/aaawd.json","name":"aaawa","type":"dataset","datatype":"JSON","cachable":1},{"source":"https://service.azigo.com/solr/nutch?","name":"aaawa_search","type":"datasource","datatype":"JSON","cachable":0},{"emit":"var url_prefix = \"http://frag.kobj.net/clients/1024/images/\";        var link_text = {    \t\"aaa\": \"<div style='padding-top: 13px'>AAA</div>\",    \t\"aarp\": \"<div style='padding-top: 13px'>AARP</div>\",    \t\"aarp_img\": \"<img style='padding-top: 3px' src='\" + url_prefix + \"aarp_logo_34.png' border='0'>\",    \t\"amex\": \"<div style='padding-top: 5px'>American<br/>Express</div>\",    \t\"bcc\": \"<img style='padding-top: 5px' src='\" + url_prefix + \"bcc_logo_34.png' border='0'>\",    \t\"ebates\": \"<div style='padding-top: 13px'>eBates</div>\",    \t\"ebates_img\": \"<img style='padding-top: 7px' src='\" + url_prefix + \"ebates_logo_34.png' border='0'>\",    \t\"lemay\": \"<img style='padding-top: 7px' src='\" + url_prefix + \"lemay_logo_25.png' border='0'>\",    \t\"mod_text\": \"<div style='padding-top: 13px'>MoD</div>\",    \t\"mod\": \"<img style='padding-top: 3px' src='\" + url_prefix + \"mod_logo_34.png' border='0' >\",    \t\"sadv\": \"<img style='padding-top: 3px' src='\" + url_prefix + \"sadv_logo_34.png' border='0' >\",    \t\"sadv_txt\": \"<div style='padding-top: 7px'>Student<br/>Advantage</div>\",    \t\"upromise\": \"<div style='padding-top: 13px'>UPromise</div>\",    \t\"boa\": \"<img style='padding-top: 3px' src='\" + url_prefix + \"boa_logo_34.png' border='0'>\",    \t\"sep\": \"<div style='padding-top: 13px'>|</div>\",    \t\"aaawa_text\": \"<div style='padding-top: 13px'>AAA</div>\",    \t\"aaawa\": \"<img style='padding-top: 5px' src='\" + url_prefix + \"aaa_logo_34.png' border='0'>\"    };        function make_selector(key){    \tvar func = function(obj){    \t  try {        \t  function mk_anchor (o, key) {    \t    return $K('<a href=' + o.link + '/>').attr(    \t      {\"class\": 'KOBJ_'+key,    \t       \"title\": o.text || \"Click here for discounts!\"    \t      }).html(link_text[key]);    \t  }    \t  var entryURL = $K(obj).find(\"span.url, cite\").text();    \t  var host = KOBJ.get_host(entryURL);    \t  var o = KOBJ.pick(KOBJ['data'][key][host]);    \t    \t  if(!o){    \t  \to = KOBJ.pick(KOBJ['data'][key][\"www.\" + host]);    \t  \t  \t  }                              if(!o && key == 'upromise'){                    o = KOBJ.pick(KOBJ['data'][key][host.replace(/^www./, \"\")]);              }        \t    \t  if(key == 'aaawa' && host == 'www.premiumoutlets.com'){    \t  \tif(!entryURL.match(/^www\\.premiumoutlets\\.com(\\/seattle|\\/ |$)/)){    \t  \t\t  \t  \t\t  \t  \t\treturn false;    \t  \t}    \t  }    \t    \t    \t  if(key == 'aaawa' && host == 'www.diamondparking.com'){    \t  \tif(!entryURL.match(/^www\\.diamondparking\\.com\\/Airport\\/Spokane.aspx/)){    \t  \t\t  \t  \t\t  \t  \t\treturn false;    \t  \t}    \t  }    \t    \t  if(o) {            \t     return mk_anchor(o,key);    \t  } else {    \t    return false;    \t  }            \t} catch(e) {    \t\tvar txt=\"_s=1d895cc0802263e1c523349091752b25&_r=img\";    \t\ttxt+=\"&Msg=\"+escape(e.message ? e.message : e);    \t\ttxt+=\"&URL=\"+escape(e.fileName ? e.fileName : \"\");    \t\ttxt+=\"&Line=\"+ (e.lineNumber ? e.lineNumber : 0);    \t\ttxt+=\"&name=\"+escape(e.name ? e.name : e);    \t\ttxt+=\"&Platform=\"+escape(navigator.platform);    \t\ttxt+=\"&UserAgent=\"+escape(navigator.userAgent);    \t\ttxt+=\"&stack=\"+escape(e.stack ? e.stack : \"\");    \t\tvar i = document.createElement(\"img\");    \t\ti.setAttribute(\"src\", \"http://www.errorstack.com/submit?\" + txt);    \t\tdocument.body.appendChild(i);    \t    \t}            \t};    \treturn func;    }        function make_selector_exact_match(key){    \tvar func = function(obj){    \t  try {        \t  function mk_anchor (o, key) {    \t    return $K('<a href=' + o.link + '/>').attr(    \t      {\"class\": 'KOBJ_'+key,    \t       \"title\": o.text || \"Click here for discounts!\"    \t      }).html(link_text[key]);    \t  }    \t  var otherURL = $K(obj).find(\"span.url, cite\").text();              var entryURL = $K(obj).find(\"span.url, cite\").text().replace(/\\s+.*$/, \"\").replace(/\\/$/, \"\").replace(/^www\\./, \"\").toLowerCase();    \t              var o = KOBJ.pick(KOBJ['data'][key][entryURL]);    \t    \t  if(o) {    \t     return mk_anchor(o,key);    \t  } else {    \t    return false;    \t  }            \t} catch(e) {    \t\tvar txt=\"_s=1d895cc0802263e1c523349091752b25&_r=img\";    \t\ttxt+=\"&Msg=\"+escape(e.message ? e.message : e);    \t\ttxt+=\"&URL=\"+escape(e.fileName ? e.fileName : \"\");    \t\ttxt+=\"&Line=\"+ (e.lineNumber ? e.lineNumber : 0);    \t\ttxt+=\"&name=\"+escape(e.name ? e.name : e);    \t\ttxt+=\"&Platform=\"+escape(navigator.platform);    \t\ttxt+=\"&UserAgent=\"+escape(navigator.userAgent);    \t\ttxt+=\"&stack=\"+escape(e.stack ? e.stack : \"\");    \t\tvar i = document.createElement(\"img\");    \t\ti.setAttribute(\"src\", \"http://www.errorstack.com/submit?\" + txt);    \t\tdocument.body.appendChild(i);    \t    \t}            \t};    \treturn func;    }        aaa_selector = make_selector('aaa');    aarp_selector = make_selector('aarp');    amex_selector = make_selector('amex');    ebates_selector = make_selector('ebates');    lemay_selector = make_selector('lemay');    mod_selector = make_selector('mod');    sadv_selector = make_selector('sadv');    upromise_selector = make_selector('upromise');    aaawa_selector = make_selector_exact_match('aaawa');        function get_host(s) {     var h = \"\";     try {       h = s.match(/^(?:\\w+:\\/\\/)?([\\w.]+)/)[1];     } catch(err) {     }     return h;    }        function pick (o) {        if (o) {            return o[Math.floor(Math.random()*o.length)];        } else {            return o;        }    }                    "}],"global_start_line":9,"dispatch":[],"dispatch_start_col":null,"meta_start_line":2,"rules":[{"cond":{"args":[{"source":"page","predicate":"env","args":[{"val":"datasets","type":"str"}],"type":"qualified"},{"val":"(^|,)aaawa(,|$)","type":"str"}],"type":"ineq","op":"like"},"blocktype":"every","actions":[{"action":{"source":null,"name":"annotate_search_results","args":[{"val":"aaawa_selector","type":"var"}],"modifiers":[{"value":{"val":"remindme","type":"str"},"name":"name"},{"value":{"args":[{"val":"url_prefix","type":"var"},{"val":"remindme_bar40_l.png","type":"str"}],"type":"prim","op":"+"},"name":"head_image"},{"value":{"args":[{"val":"url_prefix","type":"var"},{"val":"remindme_bar40_r.png","type":"str"}],"type":"prim","op":"+"},"name":"tail_image"},{"value":{"val":"40px","type":"str"},"name":"height"},{"value":{"val":"46px","type":"str"},"name":"left_margin"}],"vars":null},"label":null}],"post":null,"pre":[{"rhs":{"source":"page","predicate":"env","args":[{"val":"caller","type":"str"}],"type":"qualified"},"lhs":"caller","type":"expr"},{"rhs":{"obj":{"val":"caller","type":"var"},"args":[{"val":"/^.*[\\?&]q=([^&]+).*$/","type":"regexp"},{"val":"$1","type":"str"}],"name":"replace","type":"operator"},"lhs":"search_query","type":"expr"},{"rhs":{"source":"datasource","predicate":"aaawa_search","args":[{"args":[{"val":"q=","type":"str"},{"args":[{"val":"search_query","type":"var"},{"val":"&fq=source:aaawa","type":"str"}],"type":"prim","op":"+"}],"type":"prim","op":"+"}],"type":"qualified"},"lhs":"search_data","type":"expr"},{"rhs":{"val":"http://frag.kobj.net/clients/1024/images/","type":"str"},"lhs":"url_prefix","type":"expr"},{"rhs":{"val":"http://service.azigo.com/updates/remindme/images/","type":"str"},"lhs":"logo_url_prefix","type":"expr"}],"name":"aaawa","start_col":5,"emit":"search_percolate = {};  search_percolate.domains = {};    function elevate_search_results (annotate) {    var page = 1;      function mk_list_item(i) {      return $K(i).attr({\"class\": \"KOBJ_item\"}).css({\"margin\":\"5px\"});    }      function mk_rm_div (anchor) {                var logo_item = mk_list_item(anchor);        var url = link_text['aaawa'].replace(/^.*src='/, \"\").replace(/'.*$/, \"\");        var logo = $K('<img>');      logo.attr({\"src\":url,\"align\":\"left\"});      logo.css({\"margin\":\"5px\"});        var header=$K(\"<div>\");      header.css({\"height\":\"30px\", \"margin\":\"0px 0px 0px 0px\"});      header.append(logo);        var top_box = $K('<ol>');      top_box.css({\"display\": \"block\",\"padding-top\": \"0px\"});      top_box.attr(\"id\", \"KOBJ_top_box\");      top_box.append(logo_item);        var inner_div = $K('<div>');      inner_div.css({\"margin-top\":\"0px\",\"border-top\":\"2px solid black\",\"width\":\"100%\"});       inner_div.css({});      inner_div.append(top_box);        var rm_div = $K('<div>');      rm_div.attr({\"class\":\"cxx\"});      rm_div.css({\"border\":\"1px solid black\",\"padding-right\": \"0px\",\"min-height\": \"80px\", \"max-width\":\"48em\", \"margin-top\":\"10px\",\"margin-bottom\":\"10px\",\"margin-left\":\"10px\",\"margin-right\":\"10px\"});      rm_div.append(header);      rm_div.append($K('<br>'));      rm_div.append(inner_div);      return rm_div;    }      function move_item (obj) {      if($K('#KOBJ_top_box').find(\"li\").is('.KOBJ_item')) {                            $K('#KOBJ_top_box').append(mk_list_item(obj));      } else {        $K(\"#res\").before(mk_rm_div(obj));      }    }      depth_search();      function depth_search(){       var matches = {};       var o = eval(search_data);       if(o) {  \t     var response = o.response;               if(response) {  \t\t     var docs = response.docs;                       if(docs) {  \t\t\t     for(var i=0; i<docs.length; i++) {  \t\t\t       var d = docs[i].url.replace(/http:\\/\\/([A-Za-z0-9.-]+)\\/.*/,\"$1\");  \t\t\t       matches[d] = 1;  \t\t\t     }  \t\t     }               }       }         for(var d in matches) {          var contents = annotate(d,page);  \tif (contents) {  \t  move_item(contents);  \t}       }    }  }      function abq_selector(obj, page){    function mk_anchor (o, host, key) {      var url_prefix = \"http://www.azigo.com/sales-demo/\";        var lnk = $K('<a href=' + o.link + '/>');              lnk.attr({\"class\": 'KOBJ_'+key,\"title\": host});      lnk.text(host);            var desc = $K('<span>' + o.text + '</span>');          desc.css({\"margin\":\"5px\",\"font-weight\":\"bold\"});        var pg = $K('<span>');      pg.text(\"Page #\"+page);      pg.css({\"margin\":\"5px\",\"color\":\"#676767\"});        var line = $K('<div>');      line.append(lnk);      line.append(desc);          line.attr({\"class\": \"KOBJ_item\"});        return $K(\"<li>\").append(line);    }      var host = KOBJ.get_host(obj);    host = host.replace(/^www./, \"\");    var o = KOBJ.pick(KOBJ['data']['aaawa'][host]);    if(o && !search_percolate.domains[host]) {       search_percolate.domains[host] = 1;                 return mk_anchor(o,host,'abq');    } else {       return false;    }  }    elevate_search_results(abq_selector);              ","state":"active","callbacks":{"success":[{"attribute":"class","trigger":null,"value":"KOBJ_aaawa","type":"click"}],"failure":null},"pagetype":{"event_expr":{"pattern":"^http://www.google.com","legacy":1,"type":"prim_event","vars":[],"op":"pageview"},"foreach":[]},"start_line":15}],"meta_start_col":5,"meta":{"logging":"off","name":"AAAWA Spotlight Test","meta_start_line":2,"description":"Temporary     \n","meta_start_col":5},"dispatch_start_line":null,"global_start_col":5,"ruleset_name":"a104x2"}
