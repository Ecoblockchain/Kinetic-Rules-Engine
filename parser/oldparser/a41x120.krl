{"global":[{"source":"http://spreadsheets.google.com/feeds/list/0AlqLEISUOdH-dEl0eEdvVFpkMXNWSzJENnQwc1ExNWc/od6/public/values?alt=json","name":"spreadsheetSource","type":"datasource","datatype":"JSON","cachable":{"period":"years","value":"1"}},{"source":"http://spreadsheets.google.com/feeds/list/0AlqLEISUOdH-dEl0eEdvVFpkMXNWSzJENnQwc1ExNWc/od6/public/values?alt=json","name":"spreadsheet","type":"dataset","datatype":"JSON","cachable":{"period":"years","value":"1"}},{"source":"http://spreadsheets.google.com/feeds/cells/0AlqLEISUOdH-dEl0eEdvVFpkMXNWSzJENnQwc1ExNWc/od6/public/values?alt=json&range=A2:A300","name":"domains","type":"dataset","datatype":"JSON","cachable":{"period":"years","value":"1"}},{"content":".k-reset * {\n        margin: 0;\n        padding: 0;\n        border: 0;\n        outline: 0;\n        font-size:24px;\n        font-size: 100%;\n        font-weight: normal !important;\n        vertical-align: baseline;\n        background: transparent;\n        color: #000;\n        font-family:arial,sans-serif;\n        direction: ltr;\n        line-height: 16px;\n        letter-spacing: normal;\n        text-align: left;\n        text-decoration: none;\n        text-indent: 0;\n        text-shadow: none;\n        text-transform: none;\n        vertical-align: baseline;\n        white-space: normal;\n        word-spacing: normal;\n        font: normal normal normal medium/1 sans-serif;\n        list-style: none;\n        clear: none;\n        z-index: 999999;\n      }\n      .k-reset a:hover, .k-reset a:active, .k-reset a:focus {\n        color: #1100CC;\n      }\n      .k-reset a {\n        color: #1100CC;\n      }\n\n      img.acxiom-annotation {\n        float:right;\n        margin:6px 8px 0 0;\n        z-index: 999999;\n      }\n\n      .acxiom-discount-details {\n        -moz-border-radius:5px 5px 5px 5px;\n        background-color:white;\n        border:1px solid #999999;\n        padding:9px;\n        width:345px;\n        display: none;\n        font-weight: normal;\n        font-size: 17px;\n        font-family: arial, sans-serif;\n      }\n\n      .acxiom-discount-details a {\n        text-decoration: underline;\n        font-size: 17px;\n        font-weight: bold;\n      }\n\n      .show {\n        display: block !important;\n      }\n\n      .hide {\n        display: none !important;\n      }\n\n      .relative {\n        position: relative;\n      }\n\n      .closer {\n        height:8px;\n        position:absolute;\n        right:9px;\n        top:7px;\n        cursor: pointer;\n      }\n      #closer-text {\n        position: absolute;\n        right: 18px;\n        top: 7px;\n        font-size: 8px;\n        cursor: pointer;\n      }\n\n      .k-reset * {\n        margin: 0;\n        padding: 0;\n        border: 0;\n        outline: 0;\n        font-size:24px;\n        font-size: 100%;\n        font-weight: normal !important;\n        vertical-align: baseline;\n        background: transparent;\n        color: #000;\n        font-family:arial,sans-serif;\n        direction: ltr;\n        line-height: 16px;\n        letter-spacing: normal;\n        text-align: left;\n        text-decoration: none;\n        text-indent: 0;\n        text-shadow: none;\n        text-transform: none;\n        vertical-align: baseline;\n        white-space: normal;\n        word-spacing: normal;\n        font: normal normal normal medium/1 sans-serif;\n        list-style: none;\n        clear: none;\n        z-index: 999999;\n      }\n      .k-reset a:hover, .k-reset a:active, .k-reset a:focus {\n        color: #1100CC;\n      }\n      .k-reset a {\n        color: #1100CC;\n      }\n\n      img.acxiom-annotation {\n        float:right;\n        margin:6px 8px 0 0;\n        z-index: 999999;\n      }\n\n      .acxiom-discount-details {\n        -moz-border-radius:5px 5px 5px 5px;\n        background-color:white;\n        border:1px solid #999999;\n        padding:9px;\n        width:345px;\n        display: none;\n        font-weight: normal;\n        font-size: 17px;\n        font-family: arial, sans-serif;\n      }\n\n      .acxiom-discount-details a {\n        text-decoration: underline;\n        font-size: 17px;\n        font-weight: bold;\n      }\n\n      .show {\n        display: block !important;\n      }\n\n      .hide {\n        display: none !important;\n      }\n\n      .relative {\n        position: relative;\n      }\n\n      .closer {\n        height:8px;\n        position:absolute;\n        right:9px;\n        top:7px;\n        cursor: pointer;\n      }\n      #closer-text {\n        position: absolute;\n        right: 18px;\n        top: 7px;\n        font-size: 8px;\n        cursor: pointer;\n      }\n\t\t#spotlight-reminders-wrapper{\n\t\t\theight:24px;\n\t\t\tbackground:#e4effd;\n\t\t\tpadding:0 0 0 9px;\n\t\t\tmargin:15px 0;\n\t\t\tfont-size:small;\n\t\t}\n\n\t\t.remindme-reminders-wrapper{\n\t\t\theight:24px;\n\t\t\tbackground:white;\n\t\t\tpadding:0;\n\t\t\tmargin:0;\n\t\t\tfont-size:small;\n\t\t\twidth:450px;\n\t\t}\n\n\t\tp.descriptive-text{\n\t\t\tfloat:right;\n\t\t\tmargin:4px 9px 0 0;\n\t\t\tpadding:0;\n\t\t\tcolor:#7a7a7a;\n\t\t\tfont-size:small;\n\t\t}\n\n\t\tul.spotlightReminders{\n\t\t\tfloat:left;\n\t\t\tmargin:0;\n\t\t\tpadding:0;\n\t\t\tlist-style:none;\n\t\t\theight:24px;\n\t\t}\n\n\t\tul.spotlightReminders li{\n\t\t\tdisplay:block;\n\t\t\tfloat:left !important;\n\t\t\tmargin:3px 3px 0 0;\n\t\t}\n\n\t\tul.spotlightReminders li.azigo-logo{\n\t\t\tmargin:4px 0 0 0;\n\t\t}\n\n\t\tul.spotlightReminders li.txt-reminder{\n\t\t\tpadding:0 0 0 4px;\n\t\t\tmargin:4px 3px 0 0;\n\t\t\tcolor:#2b30d1;\n\t\t}\n\n\t\t.clear{\n\t\t\tclear:both;\n\t\t}       \n\n\t\t.remindme-flyout-wrapper{\n\t\t\tborder: 3px solid #e471ac;\n\t\t\twidth:450px;\n\t\t\tmargin:0 0 0 20px;\n\t\t\tposition: absolute;\n\t\t\tbackground-color: white;\n\t\t\tdisplay: none;\n\t\t\tz-index: 1;\n\t\t\ttext-align:left;\n\t\t}\n\n\t\t.flyout-pointer{\n\t\t\tbackground:url(\"http://aaa-demo.s3.amazonaws.com/FlyoutPoint.png\") no-repeat;\n\t\t\theight:11px;\n\t\t\twidth:15px;\n\t\t\tposition:relative;\n\t\t\tmargin:-11px 0 0 20px;\n\t\t}\n\n\t\t.flyout-reminder-details{\n\t\t\tpadding:8px 10px;\n\t\t\tborder-bottom:1px solid #c2c2c2;\n\t\t\tcolor: black;\n\t\t\tfloat: left;\n\t\t}\n\n\t\tp.flyout-reminder-url{\n\t\t\tmargin:0 0 5px 0;\n\t\t\tpadding:0;\n\t\t}\n\n\t\t.flyout-reminder-details ul{\n\t\t\tmargin:0;\n\t\t\tpadding:0;\n\t\t\tlist-style:none;\n\t\t\tline-height:14px;\n\t\t}\n\n\t\t.flyout-reminder-details ul li{\n\t\t\tdisplay:block;\n\t\t\tfloat:left !important;\n\t\t\tmargin:0 4px 0 0;\n\t\t\tpadding:0;\n\t\t}\n\n\t\t.flyout-reminder-details ul li.flyout-reminder-url{\n\t\t\tmargin:0 0 5px 0;\n\t\t\tpadding:0;\n\t\t\twidth:250px;\n\t\t}\n\n\t\t.flyout-reminder-details ul li.flyout-reminder-text{\n\t\t\twidth:230px;\n\t\t}\n\n\t\t.flyout-reminder-details ul li.flyout-reminder-button{\n\t\t\tmargin:0;\n\t\t}\n\n\t\ta.flyout-reminder-button{\n\t\t\tdisplay:block;\n\t\t\tfont-size:10px;\n\t\t\tfont-weight:bold;\n\t\t\tfont-family:Verdana, sans-serif, Arial, Helvetica;\n\t\t\tbackground:#57b6e3;\n\t\t\ttext-align:center;\n\t\t\ttext-decoration:none;\n\t\t\theight:16px;\n\t\t\twidth:96px;\n\t\t\tcolor:#fff;\n\t\t\tpadding:2px 0 0 0;\n\t\t\tmargin:0;\n\t\t}\n\n\n\t\t.clearfix:after {\n\t\t    content: \".\";\n\t\t    display: block;\n\t\t    clear: both;\n\t\t    visibility: hidden;\n\t\t    line-height: 0;\n\t\t    height: 0;\n\t\t}\n\n\t\t.clearfix {\n\t\t    display: inline-block;\n\t\t}\n\n\t\thtml[xmlns] .clearfix {\n\t\t    display: block;\n\t\t}\n\n\t\t* html .clearfix {\n\t\t    height: 1%;\n\t\t}   \n\n\t\t.flyout-wrapper{\n\t\t\tborder: 3px solid #e471ac;\n\t\t\twidth:450px;\n\t\t\tmargin:-15px 0 0 29px;\n\t\t\tposition: absolute;\n\t\t\tbackground-color: white;\n\t\t\tdisplay: none;\n\t\t\tz-index: 1;\n\t\t}\n\n\n\n\t\t.flyout-reminder-details{\n\t\t\tpadding:8px 10px;\n\t\t\tborder-bottom:1px solid #c2c2c2;\n\t\t\tfont-size: small;\n\t\t\twidth:430px;\n\t\t}\n\n\t\t#kobj_upgrade_notice .dismiss {\n\t\t\tcolor:#710100;\n\t\t\tpadding:10px;\n\t\t\ttext-align:center;\n\t\t\ttext-decoration:underline;\n\t\t\tcursor: pointer;\n\t\t}\n\t","type":"css"},{"emit":"// JSON Path lib:\n/* JSONPath 0.8.0 - XPath for JSON\n *\n * Copyright (c) 2007 Stefan Goessner (goessner.net)\n * Licensed under the MIT (MIT-LICENSE.txt) licence.\n */\nKOBJ.jsonPath = function(obj, expr, arg) {\n   var P = {\n      resultType: arg && arg.resultType || \"VALUE\",\n      result: [],\n      normalize: function(expr) {\n         var subx = [];\n         return expr.replace(/[\\['](\\??\\(.*?\\))[\\]']/g, function($0,$1){return \"[#\"+(subx.push($1)-1)+\"]\";})\n                    .replace(/'?\\.'?|\\['?/g, \";\")\n                    .replace(/;;;|;;/g, \";..;\")\n                    .replace(/;$|'?\\]|'$/g, \"\")\n                    .replace(/#([0-9]+)/g, function($0,$1){return subx[$1];});\n      },\n      asPath: function(path) {\n         var x = path.split(\";\"), p = \"$\";\n         for (var i=1,n=x.length; i<n; i++)\n            p += /^[0-9*]+$/.test(x[i]) ? (\"[\"+x[i]+\"]\") : (\"['\"+x[i]+\"']\");\n         return p;\n      },\n      store: function(p, v) {\n         if (p) P.result[P.result.length] = P.resultType == \"PATH\" ? P.asPath(p) : v;\n         return !!p;\n      },\n      trace: function(expr, val, path) {\n         if (expr) {\n            var x = expr.split(\";\"), loc = x.shift();\n            x = x.join(\";\");\n            if (val && val.hasOwnProperty(loc))\n               P.trace(x, val[loc], path + \";\" + loc);\n            else if (loc === \"*\")\n               P.walk(loc, x, val, path, function(m,l,x,v,p) { P.trace(m+\";\"+x,v,p); });\n            else if (loc === \"..\") {\n               P.trace(x, val, path);\n               P.walk(loc, x, val, path, function(m,l,x,v,p) { typeof v[m] === \"object\" && P.trace(\"..;\"+x,v[m],p+\";\"+m); });\n            }\n            else if (/,/.test(loc)) { // [name1,name2,...]\n               for (var s=loc.split(/'?,'?/),i=0,n=s.length; i<n; i++)\n                  P.trace(s[i]+\";\"+x, val, path);\n            }\n            else if (/^\\(.*?\\)$/.test(loc)) // [(expr)]\n               P.trace(P.eval(loc, val, path.substr(path.lastIndexOf(\";\")+1))+\";\"+x, val, path);\n            else if (/^\\?\\(.*?\\)$/.test(loc)) // [?(expr)]\n               P.walk(loc, x, val, path, function(m,l,x,v,p) { if (P.eval(l.replace(/^\\?\\((.*?)\\)$/,\"$1\"),v[m],m)) P.trace(m+\";\"+x,v,p); });\n            else if (/^(-?[0-9]*):(-?[0-9]*):?([0-9]*)$/.test(loc)) // [start:end:step]  phyton slice syntax\n               P.slice(loc, x, val, path);\n         }\n         else\n            P.store(path, val);\n      },\n      walk: function(loc, expr, val, path, f) {\n         if (val instanceof Array) {\n            for (var i=0,n=val.length; i<n; i++)\n               if (i in val)\n                  f(i,loc,expr,val,path);\n         }\n         else if (typeof val === \"object\") {\n            for (var m in val)\n               if (val.hasOwnProperty(m))\n                  f(m,loc,expr,val,path);\n         }\n      },\n      slice: function(loc, expr, val, path) {\n         if (val instanceof Array) {\n            var len=val.length, start=0, end=len, step=1;\n            loc.replace(/^(-?[0-9]*):(-?[0-9]*):?(-?[0-9]*)$/g, function($0,$1,$2,$3){start=parseInt($1||start);end=parseInt($2||end);step=parseInt($3||step);});\n            start = (start < 0) ? Math.max(0,start+len) : Math.min(len,start);\n            end   = (end < 0)   ? Math.max(0,end+len)   : Math.min(len,end);\n            for (var i=start; i<end; i+=step)\n               P.trace(i+\";\"+expr, val, path);\n         }\n      },\n      eval: function(x, _v, _vname) {\n         try { return $ && _v && eval(x.replace(/@/g, \"_v\")); }\n         catch(e) { throw new SyntaxError(\"jsonPath: \" + e.message + \": \" + x.replace(/@/g, \"_v\").replace(/\\^/g, \"_a\")); }\n      }\n   };\n\n   var $ = obj;\n   if (expr && obj && (P.resultType == \"VALUE\" || P.resultType == \"PATH\")) {\n      P.trace(P.normalize(expr).replace(/^\\$;/,\"\"), obj, \"$\");\n      return P.result.length ? P.result : false;\n   }\n} \n\t\t\n\n\t\tvar spreadsheet = KOBJ.data.spreadsheet;\n\n \t        var globalData = {\n                                \"Source\" : \"aaaw\",\n\t\t\t\t\"RemindMeIconUrl\" : \"http://aaa-demo.s3.amazonaws.com/aaa_18x24.png\",\n                                \"FlyoutIconUrl\" : \"http://aaa-demo.s3.amazonaws.com/aaa_60x90.png\"\n\t\t\t };\n\n\tfunction remindMeSelector(obj) { \n\t\tobj = $KOBJ(obj);\n                var annotationContent;\n\n\t\tvar jsonPathString = \"$..entry[?(@.gsx$domain.$t=='\"+KOBJ.get_host(obj.data(\"domain\")).replace(/^www\\./,\"\")+\"')]\";\n\n\t\tvar objData = KOBJ.jsonPath(spreadsheet,jsonPathString)[0];\n\n\t\tif(objData){\n\t\t\tobjData.url = obj.data(\"url\");\n\t\t\tKOBJ.spotlightData = KOBJ.spotlightData || [];\n\t\t\tKOBJ.spotlightData.push(objData);\n\t\t} else {\n\t\t\treturn false;\n\t\t}\n\n\t\tvar remindMeDomain = obj.data(\"domain\").replace(/[.#]/g,\"\");\n                var remindMeDivId = \"remindMe_\"+remindMeDomain;\n                var remindMeFlyoutDivId = \"remindMeFlyout_\"+remindMeDomain;\n\t\tvar remindMeWrapper = \"remindMeWrapper_\"+remindMeDomain;\n\n\t\tif($K(\"#\"+remindMeDivId).length == 0) {\n\t\t   var remindMeMainDiv = createRemindMeDiv(remindMeDivId);\n                   var remindMeFlyoutDiv = createRemindMeFlyoutDiv(remindMeFlyoutDivId);\n\n\t\t   remindMeFlyoutDiv.append(\n\t\t\tgetFlyoutDetails(\n                                                 objData[\"gsx$title\"][\"$t\"],\n                                                 objData.url, \n                                                 globalData.FlyoutIconUrl, \n                                                 \"Click here for AAA discount details!!\", \n                                                 \"aaaw\"\n                                          )\n\t\t   );\n\n \t           var remindMeDiv = $K(\"<div></div>\");\n\n                   var wrapperDiv = $K(\"<div id='\"+remindMeWrapper+\"' class='remindme-reminders-wrapper'></div>\");\n\t\t   wrapperDiv.append(remindMeMainDiv);\n\n\t\t   remindMeDiv.append(wrapperDiv);\n\n\t           remindMeDiv.append(remindMeFlyoutDiv);\n\n                   annotationContent = remindMeDiv;\n                   registerEvents(remindMeDivId, remindMeFlyoutDivId, false);\n                }\n                else { \n                   if($K(\"#\"+remindMeDivId).find(\"#img_\"+globalData.Source+\"_remindMe\").length) {\n                        return false;\n                   }\n\n\t\t   if($K(\"#\"+remindMeDivId).children(\".txt-reminder\").length) {\n                      $K(\"#\"+remindMeDivId).children(\".txt-reminder\").after(\n                                              makeListItem(\n\t\t                                    null, \n\t\t                                    null, \n\t\t                                    $K(\"<img id='img_\"+globalData.Source+\"_remindMe' src='\"+globalData.RemindMeIconUrl+\"' />\")\n\t\t                              )\n                      );\n                   }\n\n\t\t   if($K(\"#\"+remindMeFlyoutDivId).length) {\n\t\t\t$K(\"#\"+remindMeFlyoutDivId).append(\n\t\t\t\t\tgetFlyoutDetails(\n                                                 objData[\"gsx$title\"][\"$t\"],\n                                                 obj.data(\"url\"), \n                                                 globalData.FlyoutIconUrl, \n                                                 \"Click here for AAA discount details!!\", \n                                                 \"aaaw\"\n                                        )\n\t\t        );\n  \t\t   }\n\n\t\t   //Increment the counter.\n\t\t   var spanReminders = $K(\"#\"+remindMeDivId).children(\".txt-reminder\").children(\".spanRemindMeNReminders\");\n                   if (spanReminders.length > 0)\n                   {\n                       var totalReminders = parseInt(spanReminders.text());\n                       if (!isNaN(totalReminders))\n                       {\n\t                    totalReminders = totalReminders + 1;\n                            spanReminders.text(String(totalReminders));\n\t                    if(totalReminders == 1) {\n\t\t               $K(\"#\"+remindMeDivId).children(\".txt-reminder\").children(\".spanRemindMeTextReminders\").text(\"Reminder\");\n\t                    }\n\t                    else {\n\t\t               $K(\"#\"+remindMeDivId).children(\".txt-reminder\").children(\".spanRemindMeTextReminders\").text(\"Reminders\");\n\t                    }\n                       }                \n\t\t   }\n                   annotationContent = false;\n                }\n\t     return annotationContent;\n        }\n\n        function registerEvents(remindMeDivId, remindMeFlyoutDivId, isSpotlightEvent) {\t\t\n\t     $K(\"#\"+remindMeDivId).live('mouseover', function () {\n\t\t   $K('#'+remindMeDivId).css({'cursor':'hand','cursor':'pointer'});\n                   $K('#'+remindMeFlyoutDivId).show();\n\t     });\n\n\t     $K(\"#\"+remindMeDivId).live('mouseout', function () {\n                   \n                   if(isSpotlightEvent) {\n                      $K(\"#spotlight-reminders-wrapper\").live('mouseover', function() {\n                           $K('#'+remindMeFlyoutDivId).show();                           \n                      });\n                      $K(\"#spotlight-reminders-wrapper\").live('mouseout', function() {\n                           $K('#'+remindMeFlyoutDivId).hide();   \n\t\t\t   $K(\"#spotlight-reminders-wrapper\").die('mouseover');\n\t\t\t   $K(\"#spotlight-reminders-wrapper\").die('mouseout');\n                      });\n                   }\n\t\t   else {\n\t\t\t$K(\"#\"+remindMeDivId).parent().mouseover(function() {\n                           $K('#'+remindMeFlyoutDivId).show();    \n\t\t\t});\n                      $K(\"#\"+remindMeDivId).parent().mouseout(function() {\n                           $K('#'+remindMeFlyoutDivId).hide();   \n\t\t\t   $K(\"#\"+remindMeDivId).parent().unbind('mouseover');\n\t\t\t   $K(\"#\"+remindMeDivId).parent().unbind('mouseout');\n                      });\n\t\t   }\n\n\t\t   $K('#'+remindMeFlyoutDivId).hide();\n\t     });\n\n\t     $K(\"#\"+remindMeFlyoutDivId).live('mouseover', function () {\n        \t   $K('#'+remindMeFlyoutDivId).show();\n\t     });\n\n\t     $K(\"#\"+remindMeFlyoutDivId).live('mouseout', function () {\n\t\t   $K('#'+remindMeFlyoutDivId).hide();\n\t\t   if(isSpotlightEvent) {\n\t\t\t   $K(\"#spotlight-reminders-wrapper\").die('mouseover');\n\t\t\t   $K(\"#spotlight-reminders-wrapper\").die('mouseout');\n\t\t   }\n\t\t   else {\n\t\t\t   $K(\"#\"+remindMeDivId).parent().unbind('mouseover');\n\t\t\t   $K(\"#\"+remindMeDivId).parent().unbind('mouseout');\n\t\t   }\n             });\n        }\n\n\tfunction createRemindMeDiv(remindMeDivId) {\n             var remindMeMainUl = $K(\"<ul></ul>\");\n             remindMeMainUl.attr({\"id\":remindMeDivId, \"class\":\"spotlightReminders\"});\n\n             remindMeMainUl.append(\n                  makeListItem(null, \"azigo-logo\", $K(\"<img src='http://aaa-demo.s3.amazonaws.com/azigo_16x16.png' />\"))\n             );\n\n             remindMeMainUl.append(\n                  makeListItem(\n\t\t     \"remindme-txt-reminder\", \n\t\t     \"txt-reminder\", \n\t\t     \"<span class='spanRemindMeNReminders'>1</span> <span class='spanRemindMeTextReminders'>Reminder</span>\"\n\t\t  )\n             );\n\n             remindMeMainUl.append(\n                  makeListItem(\n\t\t     null, \n\t\t     null, \n\t\t     $K(\"<img id='img_\"+globalData.Source+\"_remindMe' src='\"+globalData.RemindMeIconUrl+\"' />\")\n\t\t  )\n             );\n\n             remindMeMainUl.append(\n                  makeListItem(null, null, $K(\"<img src='http://aaa-demo.s3.amazonaws.com/FlyoutIndicator.png' />\"))\n             );\n\n             return remindMeMainUl;\n        }\n\n\tfunction createRemindMeFlyoutDiv(remindMeFlyoutDivId)\n        {\n\t    var remindMeFlyoutDiv = $K(\"<div></div>\");\n\t    remindMeFlyoutDiv.attr({\"id\":remindMeFlyoutDivId, \"class\":\"remindme-flyout-wrapper\"});\n\t    remindMeFlyoutDiv.append($K(\"<div></div>\").attr(\"class\", \"flyout-pointer\"));\n            return remindMeFlyoutDiv;\n        }\n\n\tfunction makeListItem(listItemId, listItemClass, listItemContent) {\n             var listItem = $K(\"<li></li>\");\n             if(listItemClass != null) {\n                 listItem.attr(\"class\", listItemClass);\n             }\n\t     if(listItemId != null) {\n\t         listItem.attr(\"id\", listItemId);\n\t     }\n             listItem.append(listItemContent);\n             return listItem;        \n        }\n\n\tfunction makeAnchorTag(aUrl, aClass, aText)\n        {\n             var anchorTag = $K(\"<a></a>\");\n             anchorTag.attr(\"href\", aUrl);\n             if(aClass != null) {\n                 anchorTag.attr(\"class\", aClass);\n             }\n             anchorTag.append(aText);\n             return anchorTag;\n        }\n\n    /*\n\tFunction that takes the details to be displayed in the flyout and creates a flyout component with those details.\n    */\n    function getFlyoutDetails(clientName, clientUrl, clientLogo, displayText, buttonType)\n    { \t         \n\tvar flyoutDetailsDiv = $K(\"<div></div>\");\n\tflyoutDetailsDiv.attr(\"class\",\"flyout-reminder-details clearfix\");\n\n        var flyoutDetailsUl = $K(\"<ul></ul>\");\n\n        flyoutDetailsUl.append(\n\t\tmakeListItem(null, null, $K(\"<img src='\"+clientLogo+\"' />\"))\n\t);\n        flyoutDetailsUl.append(\n                makeListItem(null, \"flyout-reminder-url\", makeAnchorTag(clientUrl, null, clientName))\n        );\n        flyoutDetailsUl.append(\n\t\tmakeListItem(null, \"flyout-reminder-text\", displayText)\n\t);\n\tvar discountButton = \"\";\n\t//if(buttonType === \"discount\") {\n\t\tdiscountButton = makeAnchorTag(clientUrl, \"flyout-reminder-button\", \"Click and Save\");\n\t//}\n        flyoutDetailsUl.append(\n\t\tmakeListItem(null, null, discountButton)\n\t);        \n\n        flyoutDetailsDiv.append(flyoutDetailsUl);\n            \n\treturn flyoutDetailsDiv;\n    }\n\n/*\n    Main function for the Spotlight that will be called from each rule.\n*/\nKOBJ.spotlight = function (source) {\n    /*\n\tCallback function to handle JSON data returned from the nutchfilter url.\n    */\n   displaySpotlight(KOBJ.spotlightData);\n\n    /* \n\tTake out the search string from the url and construct a remoteUrl for the current source. \n    */\n    \n\n    /*\n\tFunction to create the main div for Spotlight. It just creates the spotlight template that will be displayed \n\tabove the search results.\n    */\n    function createSpotlightMainDiv()\n    {\n\t var spotlightMainDiv = $K(\"<div></div>\");\n\t spotlightMainDiv.attr(\"id\", \"spotlight-reminders-wrapper\");\n\n         var spotlightMainUl = $K(\"<ul></ul>\");\n         spotlightMainUl.attr({\"id\":\"spotlightReminders\", \"class\":\"spotlightReminders\"});\n\n         spotlightMainUl.append(\n                    makeListItem(null, 'azigo-logo', $K(\"<img src='http://aaa-demo.s3.amazonaws.com/azigo_16x16.png' />\"))\n         );\n\n         var spotlightReminderNSpan = $K(\"<span></span>\");\n         spotlightReminderNSpan.attr(\"id\", \"spanNReminders\");\n         spotlightReminderNSpan.text(\"0\");\n\n         var spotlightReminderTextSpan = $K(\"<span></span>\");\n         spotlightReminderTextSpan.attr(\"id\", \"spanTextReminders\");\n         spotlightReminderTextSpan.text(\"Reminders\");\n\n         spotlightMainUl.append(\n                           makeListItem(\n\t\t\t\t\"spotlight-txt-reminder\", \n\t\t\t\t\"txt-reminder\", \n\t\t\t\t\"<span id='spanNReminders'>0</span> <span id='spanTextReminders'>Reminders</span>\"\n\t\t\t   )\n         );\n\n         spotlightMainUl.append(\n                    makeListItem(null, null, $K(\"<img src='http://aaa-demo.s3.amazonaws.com/FlyoutIndicator.png' />\"))\n         );\n\n         var spotlightMainP = $K(\"<p></p>\");\n         spotlightMainP.attr(\"class\", \"descriptive-text\");\n         spotlightMainP.text(\"My Sponsored Links\");\n\n         spotlightMainDiv.append(spotlightMainUl);\n         spotlightMainDiv.append(spotlightMainP);\n\n         return spotlightMainDiv;\n    }\n\n    /*\n\tFunction to create the Flyout Div for Spotlight. It just creates the flyout template that will be displayed\n\tonce user hovers over the Spotlight components.\n    */\n    function createSpotlightFlyoutDiv()\n    {\n\tvar spotlightFlyoutDiv = $K(\"<div></div>\");\n\tspotlightFlyoutDiv.attr({\"id\":\"spotlightFlyoutDiv\", \"class\":\"flyout-wrapper\"});\n\tspotlightFlyoutDiv.append($K(\"<div></div>\").attr(\"class\", \"flyout-pointer\"));\n        return spotlightFlyoutDiv;\n    }\n\n    /*\n\tCallback function to handle JSON data returned from fetch url - which gives details requierd for the flyout.\n    */\n    function flyoutContentCallback(data)\n    {\n        if($K('#spotlightFlyoutDiv').length) {\n           $K.each(data, function(){\n                        $K('#spotlightFlyoutDiv').append(\n\t\t\t\t\tgetFlyoutDetails(\n                                                 this[\"gsx$title\"][\"$t\"],\n                                                 this[\"url\"], \n                                                 globalData.FlyoutIconUrl, \n                                                 \"Click here for AAA discount details!!\", \n                                                 \"aaaw\"\n                                        )\n                        );\n                    }\n           );\n        }\n    }    \n\n    /*\n\tMain function that creates all the components required for Spotlight and injects them in the search page.\n    */\n    function displaySpotlight(response)\n    {\n        var logoUrl = globalData.RemindMeIconUrl;\n\n        if($K(\"#spotlight-reminders-wrapper\").length == 0) {\n\t    var spotlightMainDiv = createSpotlightMainDiv();\n            var spotlightFlyoutDiv = createSpotlightFlyoutDiv();\n \t    var spotlightDiv = $K(\"<div id='spotlight-main-flyout'></div>\");\n\t    spotlightDiv.append(spotlightMainDiv);\n\t    spotlightDiv.append(spotlightFlyoutDiv);\n            if($K(\"#res\").length) {\n                $K(\"#res\").prepend(spotlightDiv);\n            }\n            else if($K(\"#web\").length) {\n                $K(\"#web\").prepend(spotlightDiv);\n            }\n            else if($K(\"#results\").length) {\n                $K(\"#results\").prepend(spotlightDiv);\n            }\n        }\n\n        //Register the mousover and mouseout events to show/hide the flyout.\n\tregisterEvents(\"spotlightReminders\", \"spotlightFlyoutDiv\", true);\n\n\t/*\n\t    If the details for this source has already been injected in the page, we don't need to go further.\n\t*/\n    \tif($K(\"#img_\"+source+\"_spotlight\").length) {\n            return;\n        }\n\n        if($K(\"#spotlight-txt-reminder\").length) {\n             $K(\"#spotlight-txt-reminder\").after(\"<li><img id='img_\"+source+\"_spotlight' src='\"+logoUrl+\"' /></li>\");\n        }\n        var spanReminders = $K(\"#spanNReminders\");\n        if (spanReminders.length > 0)\n        {\n            var totalReminders = parseInt(spanReminders.text());\n           if (!isNaN(totalReminders))\n           {\n\t       if(response.length > 3) {\n\t\t   totalReminders = totalReminders + 3;\n\t       }\n\t       else {\n               \t   totalReminders = totalReminders + response.length;\n\t       }\n               spanReminders.text(String(totalReminders));\n\t       if(totalReminders == 1) {\n\t\t   $K(\"#spanTextReminders\").text(\"Reminder\");\n\t       }\n\t       else {\n\t\t   $K(\"#spanTextReminders\").text(\"Reminders\");\n\t       }\n           }\n        }\n\n         flyoutContentCallback(KOBJ.spotlightData);\n  }\n};\n            "}],"global_start_line":102,"dispatch":[{"domain":"www.google.com","ruleset_id":null},{"domain":"search.yahoo.com","ruleset_id":null},{"domain":"www.bing.com","ruleset_id":null},{"domain":"search.microsoft.com","ruleset_id":null},{"domain":"hertz.com","ruleset_id":null},{"domain":"att.com","ruleset_id":null},{"domain":"arkansaslaserandskincare.com","ruleset_id":null},{"domain":"audiusa.com","ruleset_id":null},{"domain":"avis.com","ruleset_id":null},{"domain":"bing.com","ruleset_id":null},{"domain":"backyardburgers.com","ruleset_id":null},{"domain":"bankozarks.com","ruleset_id":null},{"domain":"barnesandnoble.com","ruleset_id":null},{"domain":"home-loan1.com","ruleset_id":null},{"domain":"brooksbrothers.com","ruleset_id":null},{"domain":"budget.com","ruleset_id":null},{"domain":"caldwell-toyota.com","ruleset_id":null},{"domain":"carpetmillsar.com","ruleset_id":null},{"domain":"cc-inc.com","ruleset_id":null},{"domain":"cdw.com","ruleset_id":null},{"domain":"centralarkansascheer.com","ruleset_id":null},{"domain":"chicagoskinsolutions.com","ruleset_id":null},{"domain":"chrysler.com","ruleset_id":null},{"domain":"coltonssteakhouse.com","ruleset_id":null},{"domain":"cometcleaners.com","ruleset_id":null},{"domain":"conwaycopies.com","ruleset_id":null},{"domain":"autotropolis.com","ruleset_id":null},{"domain":"corporateperks.com","ruleset_id":null},{"domain":"cosmeticlasersolution.com","ruleset_id":null},{"domain":"dell.com","ruleset_id":null},{"domain":"detailsunlimited1.com","ruleset_id":null},{"domain":"dixiecafe.com","ruleset_id":null},{"domain":"dpw1.com","ruleset_id":null},{"domain":"elkgrovemarathon.com","ruleset_id":null},{"domain":"enterprise.com","ruleset_id":null},{"domain":"extendedlearning.org","ruleset_id":null},{"domain":"tracytidwell.com","ruleset_id":null},{"domain":"exitrealtyconway.com","ruleset_id":null},{"domain":"fordpartner.com","ruleset_id":null},{"domain":"fromyouflowers.com","ruleset_id":null},{"domain":"gifttree.com","ruleset_id":null},{"domain":"gmsupplierdiscount.com","ruleset_id":null},{"domain":"google.com","ruleset_id":null},{"domain":"hp.com","ruleset_id":null},{"domain":"iberiabankmortgage.com","ruleset_id":null},{"domain":"jackdanielsmotors.com","ruleset_id":null},{"domain":"javaroastingcafe.com","ruleset_id":null},{"domain":"josbank.com","ruleset_id":null},{"domain":"kotobistro.com","ruleset_id":null},{"domain":"landers.com","ruleset_id":null},{"domain":"larryspizzaofarkansas.com","ruleset_id":null},{"domain":"lennys.com","ruleset_id":null},{"domain":"mazzios.com","ruleset_id":null},{"domain":"midaslittlerock.com","ruleset_id":null},{"domain":"midas.com","ruleset_id":null},{"domain":"insidenissan.com","ruleset_id":null},{"domain":"nutrishopconway.com","ruleset_id":null},{"domain":"nypdpizzeria.com","ruleset_id":null},{"domain":"officedepot.com","ruleset_id":null},{"domain":"parkwayautomotive.net","ruleset_id":null},{"domain":"pcmall.com","ruleset_id":null},{"domain":"regissalons.com","ruleset_id":null},{"domain":"shadesmith.com","ruleset_id":null},{"domain":"shortysmalls.com","ruleset_id":null},{"domain":"sdcticketoffers.com","ruleset_id":null},{"domain":"simmonsfirst.com","ruleset_id":null},{"domain":"silverdollarcity.com","ruleset_id":null},{"domain":"slim-chickens.com","ruleset_id":null},{"domain":"smithford.dealerconnection.com","ruleset_id":null},{"domain":"smoothieking.com","ruleset_id":null},{"domain":"southernautomotivecompanies.com","ruleset_id":null},{"domain":"tracystocks.com","ruleset_id":null},{"domain":"stonebridgeattheranch.com","ruleset_id":null},{"domain":"stonehavenalf.com","ruleset_id":null},{"domain":"superiorchevy.net","ruleset_id":null},{"domain":"superiornissan.com","ruleset_id":null},{"domain":"sprint.com","ruleset_id":null},{"domain":"enclaveriverfront.com","ruleset_id":null},{"domain":"thefishhouse-smittys.com","ruleset_id":null},{"domain":"msauthority.com","ruleset_id":null},{"domain":"theproblemseekers.com","ruleset_id":null},{"domain":"tropicalsmoothie.com","ruleset_id":null},{"domain":"valleyautos.net","ruleset_id":null},{"domain":"vintagetovogueonline.com","ruleset_id":null},{"domain":"verizonwireless.com","ruleset_id":null},{"domain":"wingstop.com","ruleset_id":null},{"domain":"wisdells.com","ruleset_id":null},{"domain":"wonderstatemortgage.com","ruleset_id":null},{"domain":"yahoo.com","ruleset_id":null}],"dispatch_start_col":1,"meta_start_line":2,"rules":[{"cond":{"val":"true","type":"bool"},"blocktype":"every","actions":[{"action":{"source":null,"name":"set_element_attr","args":[{"val":"#kobj_upgrade_notice","type":"str"},{"val":"style","type":"str"},{"val":"display: none;","type":"str"}],"modifiers":null,"vars":null},"label":null}],"post":{"alt":null,"type":"fired","cons":[{"test":null,"value":{"val":1,"type":"num"},"name":"dismissed","domain":"ent","from":{"val":1,"type":"num"},"action":"iterator","type":"persistent","op":"+="}]},"pre":null,"name":"mark_as_read_and_dismiss_content","start_col":5,"emit":null,"state":"active","callbacks":null,"pagetype":{"event_expr":{"on":null,"domain":"web","type":"prim_event","vars":null,"op":"click","element":".dismiss"},"foreach":[]},"start_line":956},{"cond":{"args":[],"function_expr":{"val":"truth","type":"var"},"type":"app"},"blocktype":"every","actions":[{"action":{"source":null,"name":"annotate_search_results","args":[{"val":"remindMeSelector","type":"var"}],"modifiers":[{"value":{"val":[{"rhs":{"val":"none","type":"str"},"lhs":"float"},{"rhs":{"val":"0px","type":"str"},"lhs":"margin-left"},{"rhs":{"val":"0px","type":"str"},"lhs":"padding-right"}],"type":"hashraw"},"name":"outer_div_css"},{"value":{"val":[{"rhs":{"val":"0px","type":"str"},"lhs":"margin-left"},{"rhs":{"val":"0px","type":"str"},"lhs":"padding-right"},{"rhs":{"val":"5px","type":"str"},"lhs":"padding-top"}],"type":"hashraw"},"name":"inner_div_css"},{"value":{"val":[{"rhs":{"val":"0px","type":"str"},"lhs":"padding-left"},{"rhs":{"val":"normal","type":"str"},"lhs":"white-space"}],"type":"hashraw"},"name":"li_css"},{"value":{"val":"after","type":"str"},"name":"placement"},{"value":{"val":[{"rhs":{"val":[{"rhs":{"val":".sa_cc","type":"str"},"lhs":"modify"}],"type":"hashraw"},"lhs":"www.bing.com"}],"type":"hashraw"},"name":"domains"}],"vars":null},"label":null},{"action":{"source":null,"name":"annotate_local_search_results","args":[{"val":"remindMeSelector","type":"var"}],"modifiers":[{"value":{"val":"after","type":"str"},"name":"placement"},{"value":{"val":[{"rhs":{"val":[{"rhs":{"val":".sc_ol1","type":"str"},"lhs":"modify"}],"type":"hashraw"},"lhs":"www.bing.com"}],"type":"hashraw"},"name":"domains"}],"vars":null},"label":null}],"post":null,"pre":[],"name":"aaa_newui_goolge","start_col":5,"emit":"","state":"active","callbacks":{"success":[{"attribute":"class","trigger":null,"value":"flyout-reminder-button","type":"click"}],"failure":null},"pagetype":{"event_expr":{"pattern":"^http://www.google.com|^http://www.bing.com","legacy":1,"type":"prim_event","vars":[],"op":"pageview"},"foreach":[]},"start_line":965},{"cond":{"args":[],"function_expr":{"val":"truth","type":"var"},"type":"app"},"blocktype":"every","actions":[{"action":{"source":null,"name":"annotate_search_results","args":[{"val":"remindMeSelector","type":"var"}],"modifiers":[{"value":{"val":[{"rhs":{"val":"none","type":"str"},"lhs":"float"},{"rhs":{"val":"40px","type":"str"},"lhs":"height"},{"rhs":{"val":"0px","type":"str"},"lhs":"margin-left"},{"rhs":{"val":"-10px","type":"str"},"lhs":"margin-top"},{"rhs":{"val":"0px","type":"str"},"lhs":"padding-right"}],"type":"hashraw"},"name":"outer_div_css"},{"value":{"val":[{"rhs":{"val":"0px","type":"str"},"lhs":"margin-left"},{"rhs":{"val":"0px","type":"str"},"lhs":"padding-right"}],"type":"hashraw"},"name":"inner_div_css"},{"value":{"val":[{"rhs":{"val":"0px","type":"str"},"lhs":"padding-left"},{"rhs":{"val":"normal","type":"str"},"lhs":"white-space"}],"type":"hashraw"},"name":"li_css"},{"value":{"val":"after","type":"str"},"name":"placement"},{"value":{"val":[{"rhs":{"val":[{"rhs":{"val":"#web > ol > li","type":"str"},"lhs":"selector"},{"rhs":{"val":"div.res","type":"str"},"lhs":"modify"}],"type":"hashraw"},"lhs":"search.yahoo.com"}],"type":"hashraw"},"name":"domains"}],"vars":null},"label":null},{"action":{"source":null,"name":"annotate_local_search_results","args":[{"val":"remindMeSelector","type":"var"}],"modifiers":[{"value":{"val":"after","type":"str"},"name":"placement"},{"value":{"val":[{"rhs":{"val":[{"rhs":{"val":".qlmr","type":"str"},"lhs":"modify"}],"type":"hashraw"},"lhs":"search.yahoo.com"}],"type":"hashraw"},"name":"domains"}],"vars":null},"label":null}],"post":null,"pre":[],"name":"aaa_newui_yahoo","start_col":5,"emit":"","state":"active","callbacks":{"success":[{"attribute":"class","trigger":null,"value":"flyout-reminder-button","type":"click"}],"failure":null},"pagetype":{"event_expr":{"pattern":"^http://search.yahoo.com","legacy":1,"type":"prim_event","vars":[],"op":"pageview"},"foreach":[]},"start_line":996},{"cond":{"args":[],"function_expr":{"val":"truth","type":"var"},"type":"app"},"blocktype":"every","actions":[{"label":null,"emit":"KOBJ.spotlight('aaaw');                       "}],"post":null,"pre":[],"name":"aaa_newui_spotlight","start_col":5,"emit":null,"state":"active","callbacks":{"success":[{"attribute":"class","trigger":null,"value":"flyout-reminder-button","type":"click"}],"failure":null},"pagetype":{"event_expr":{"pattern":"^http://search.yahoo.com|^http://www.bing.com","legacy":1,"type":"prim_event","vars":[],"op":"pageview"},"foreach":[]},"start_line":1027},{"cond":{"args":[],"function_expr":{"val":"truth","type":"var"},"type":"app"},"blocktype":"every","actions":[{"label":null,"emit":"KOBJ.spotlight('aaaw');         KOBJ.watchDOM(\"#rso\",function() {  \t\t\t$K('#spotlight-main-flyout').remove();  \t\t\tKOBJ.spotlight('aaaw');  \t\t }  \t );                    "}],"post":null,"pre":[],"name":"aaa_newui_spotlight_google","start_col":5,"emit":null,"state":"active","callbacks":{"success":[{"attribute":"class","trigger":null,"value":"flyout-reminder-button","type":"click"}],"failure":null},"pagetype":{"event_expr":{"pattern":"^http://www.google.com","legacy":1,"type":"prim_event","vars":[],"op":"pageview"},"foreach":[]},"start_line":1044},{"cond":{"val":"true","type":"bool"},"blocktype":"every","actions":[{"action":{"source":null,"name":"float_html","args":[{"val":"absolute","type":"str"},{"val":"top:50px","type":"str"},{"val":"right:50px","type":"str"},{"val":"annotationDetail","type":"var"}],"modifiers":null,"vars":null},"label":null},{"action":{"source":null,"name":"float_html","args":[{"val":"absolute","type":"str"},{"val":"top:50px","type":"str"},{"val":"right:50px","type":"str"},{"val":"annotationButton","type":"var"}],"modifiers":null,"vars":null},"label":null},{"label":null,"emit":"// temporary fix until float_html action is fixed. Fogbugz ticket #802\n        $K(\".k-reset\").parent().css(\"display\",\"block\");\n\n        // show details when annotation image is clicked on\n        $K(\".acxiom-annotation\").click(function() {\n          if($K(\".acxiom-discount-details\").css(\"display\") == \"none\") {\n            $K(\".acxiom-discount-details\").css(\"display\",\"block\");\n          } else {\n            $K(\".acxiom-discount-details\").css(\"display\",\"none\");\n          }\n        });\n\n        // hide everything if close button is pressed\n        $K(\".closer, #closer-text\").click(function() {\n          $K(\".k-reset\").hide();\n        });\n        $KOBJ('.acxiom-discount-details').bgiframe();\n        $KOBJ('.acxiom-annotation').bgiframe();\n      "}],"post":null,"pre":[{"rhs":{"obj":{"val":"site","type":"var"},"args":[{"val":"$.gsx$content.$t","type":"str"}],"name":"pick","type":"operator"},"lhs":"desc","type":"expr"},{"rhs":"<div class=\"k-reset relative\">\n          <img id=\"discount-image-annotation\" class=\"acxiom-annotation\" src=\"http://k-misc.s3.amazonaws.com/resources/a369x51/AAA-card.jpg\" alt=\"Acxiom Discount Available!\" style=\"height:100px;\"/>\n          <img class=\"closer\" src=\"https://kynetx-apps.s3.amazonaws.com/acxiom/close.png\" />\n          <span id=\"closer-text\">close</span>\n        </div>\n      ","lhs":"annotationButton","type":"here_doc"},{"rhs":"<div class=\"k-reset\">\n          <div id=\"acxiom-discount-details\" class=\"acxiom-discount-details\">\n            <img class=\"acxiom-annotation\" src=\"http://k-misc.s3.amazonaws.com/resources/a369x51/AAA-card.jpg\" alt=\"Acxiom Discount Available!\" style=\"visibility: hidden; height:100px;\"/>\n            #{desc}\n          </div>\n        </div>\n      ","lhs":"annotationDetail","type":"here_doc"}],"name":"better_annotation","start_col":3,"emit":null,"state":"active","callbacks":{"success":[{"attribute":"id","trigger":null,"value":"discount-image-annotation","type":"click"}],"failure":null},"pagetype":{"event_expr":{"pattern":".*","legacy":1,"type":"prim_event","vars":null,"op":"pageview"},"foreach":[{"expr":{"obj":{"source":"datasource","predicate":"spreadsheetSource","args":[{"args":[{"val":"&sq=domain%3D","type":"str"},{"source":"page","predicate":"url","args":[{"val":"domain","type":"str"}],"type":"qualified"}],"type":"prim","op":"+"}],"type":"qualified"},"args":[{"val":"$.feed.entry","type":"str"}],"name":"pick","type":"operator"},"var":["site"]}]},"start_line":1062}],"meta_start_col":5,"meta":{"logging":"off","name":"AAA Demo Application","meta_start_line":2,"description":"Demo of AAA application   \n","meta_start_col":5},"dispatch_start_line":11,"global_start_col":5,"ruleset_name":"a41x120"}
